<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R Training - 07: Visualisations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>

<script src="../../site_libs/rglWebGL-binding-1.2.1/rglWebGL.js"></script>

<link href="../../site_libs/rglwidgetClass-1.2.1/rgl.css" rel="stylesheet">

<script src="../../site_libs/rglwidgetClass-1.2.1/rglClass.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/utils.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/buffer.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/subscenes.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/shaders.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/shadersrc.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/textures.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/projection.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/mouse.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/init.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/pieces.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/draw.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/controls.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/selection.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/rglTimer.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/pretty.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/axes.src.js"></script>

<script src="../../site_libs/rglwidgetClass-1.2.1/animation.src.js"></script>

<script src="../../site_libs/CanvasMatrix4-1.2.1/CanvasMatrix.src.js"></script>

<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">

<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">R Training</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../tutorials.html" aria-current="page"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../workshops.html"> 
<span class="menu-text">Workshops</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://canvas.sussex.ac.uk/courses/29761"> 
<span class="menu-text">Canvas</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../tutorials/archive_autumn_2023/00_quick_ref.html">Archive (Autumn 2023)</a></li><li class="breadcrumb-item"><a href="../../tutorials/archive_autumn_2023/07_dataviz.html">07: Visualisations</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorials Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quick_ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quick Reference</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Current</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01: IntRoduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/02_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02: IntRoduction II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/03_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03: Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/04_filter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04: Filter and Select</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/05_mutate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05: Mutate</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/06_lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06: Reproducible Linear Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/07_summarise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07: Summarise</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/08_dataviz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08: Visualisations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/09_qtrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09: Labelled Data and Qualtrics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Archive (Autumn 2023)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/00_quick_ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quick Reference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/01_02_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01/02: IntRoduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/03_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03: Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/04_lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04: Reporting Linear Models with Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/05_filter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05: Filter and Select</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06: Mutate and Summarise</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/07_dataviz.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">07: Visualisations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/08_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08: Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/09_testflight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09: Test Flight</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/10_qtrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10: Qualtrics and Labelled Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/11_qtrics2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11: Qualtrics II</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul>
  <li><a href="#what-do-ugs-know" id="toc-what-do-ugs-know" class="nav-link" data-scroll-target="#what-do-ugs-know">What do UGs know?</a></li>
  </ul></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a>
  <ul>
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#codebook" id="toc-codebook" class="nav-link" data-scroll-target="#codebook">Codebook</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#grammar-of-graphics" id="toc-grammar-of-graphics" class="nav-link" data-scroll-target="#grammar-of-graphics">Grammar of Graphics</a>
  <ul>
  <li><a href="#layers" id="toc-layers" class="nav-link" data-scroll-target="#layers">Layers</a></li>
  <li><a href="#mapping" id="toc-mapping" class="nav-link" data-scroll-target="#mapping">Mapping</a></li>
  <li><a href="#geoms-etc." id="toc-geoms-etc." class="nav-link" data-scroll-target="#geoms-etc.">Geoms, etc.</a></li>
  </ul></li>
  <li><a href="#histograms-and-density-plots" id="toc-histograms-and-density-plots" class="nav-link" data-scroll-target="#histograms-and-density-plots">Histograms and Density Plots</a>
  <ul>
  <li><a href="#adjusting-binwidth" id="toc-adjusting-binwidth" class="nav-link" data-scroll-target="#adjusting-binwidth">Adjusting Binwidth</a></li>
  <li><a href="#colour-and-fill-manual" id="toc-colour-and-fill-manual" class="nav-link" data-scroll-target="#colour-and-fill-manual">Colour and Fill Manual</a></li>
  <li><a href="#adjusting-axes-with-scale_" id="toc-adjusting-axes-with-scale_" class="nav-link" data-scroll-target="#adjusting-axes-with-scale_">Adjusting Axes with <code>scale_*()</code></a></li>
  <li><a href="#adding-a-theme" id="toc-adding-a-theme" class="nav-link" data-scroll-target="#adding-a-theme">Adding a Theme</a></li>
  <li><a href="#facet-wrap" id="toc-facet-wrap" class="nav-link" data-scroll-target="#facet-wrap">Facet Wrap</a></li>
  </ul></li>
  <li><a href="#barplots" id="toc-barplots" class="nav-link" data-scroll-target="#barplots">Barplots</a>
  <ul>
  <li><a href="#position-dodge" id="toc-position-dodge" class="nav-link" data-scroll-target="#position-dodge">Position Dodge</a></li>
  <li><a href="#reordering-categories" id="toc-reordering-categories" class="nav-link" data-scroll-target="#reordering-categories">Reordering Categories</a>
  <ul class="collapse">
  <li><a href="#option-1-scale-labels" id="toc-option-1-scale-labels" class="nav-link" data-scroll-target="#option-1-scale-labels">Option 1: Scale Labels</a></li>
  <li><a href="#option-2-factor-levels" id="toc-option-2-factor-levels" class="nav-link" data-scroll-target="#option-2-factor-levels">Option 2: Factor Levels</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#quick-test-chi2" id="toc-quick-test-chi2" class="nav-link" data-scroll-target="#quick-test-chi2">Quick Test: <span class="math inline">\(\chi^2\)</span></a></li>
  <li><a href="#raincloud-and-violin-plots" id="toc-raincloud-and-violin-plots" class="nav-link" data-scroll-target="#raincloud-and-violin-plots">Raincloud and Violin Plots</a>
  <ul>
  <li><a href="#calculating-stats" id="toc-calculating-stats" class="nav-link" data-scroll-target="#calculating-stats">Calculating Stats</a></li>
  </ul></li>
  <li><a href="#scatterplots" id="toc-scatterplots" class="nav-link" data-scroll-target="#scatterplots">Scatterplots</a>
  <ul>
  <li><a href="#line-of-best-fit" id="toc-line-of-best-fit" class="nav-link" data-scroll-target="#line-of-best-fit">Line of Best Fit</a></li>
  <li><a href="#colour-and-fill-palette" id="toc-colour-and-fill-palette" class="nav-link" data-scroll-target="#colour-and-fill-palette">Colour and Fill Palette</a></li>
  <li><a href="#d-plots" id="toc-d-plots" class="nav-link" data-scroll-target="#d-plots">3D Plots</a></li>
  </ul></li>
  <li><a href="#reporting-with-quarto" id="toc-reporting-with-quarto" class="nav-link" data-scroll-target="#reporting-with-quarto">Reporting with Quarto</a>
  <ul>
  <li><a href="#captions-and-alt-text" id="toc-captions-and-alt-text" class="nav-link" data-scroll-target="#captions-and-alt-text">Captions and Alt Text</a></li>
  <li><a href="#cross-referencing" id="toc-cross-referencing" class="nav-link" data-scroll-target="#cross-referencing">Cross-Referencing</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../tutorials/archive_autumn_2023/00_quick_ref.html">Archive (Autumn 2023)</a></li><li class="breadcrumb-item"><a href="../../tutorials/archive_autumn_2023/07_dataviz.html">07: Visualisations</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">07: Visualisations</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This tutorial focuses on creating data visualisations using the {ggplot2} package. It covers the conceptual grammar of {ggplot} and a variety of examples of common plots. It also covers how to customise key elements of the plots, such as colour, axis labeling, and adding statistical summaries, and finishes with some tips on reporting figures in Quarto.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="{ggplot2} and Data Visualisation Resources">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
{ggplot2} and Data Visualisation Resources
</div>
</div>
<div class="callout-body-container callout-body">
<p>Check out the following indispensible resources for building beautiful visualisations:</p>
<ul>
<li><a href="https://www.data-to-viz.com/">From Data to Viz</a>, a beautifully designed helper site to help you explore the options for visualising your data, with thorough links to…</li>
<li><a href="https://r-graph-gallery.com/index.html">R Graph Gallery</a>, an archive of plots in R all with reproducible code and tutorials to build them yourself.</li>
<li><a href="https://www.tidytuesday.com/">Tidy Tuesdays</a>, which releases a new dataset each week, and people build and share beautiful visualisations, along with the code and frequently their process.</li>
<li><a href="https://psyteachr.github.io/introdataviz/">Data visualisation using R, for researchers who don’t use R</a>, a fantastic how-to from the brilliant team at PsychTeachR at Glasgow, that provides a very friendly, start-to-finish walkthrough of the whole process of data reading, manipulation, and plot-building.</li>
</ul>
</div>
</div>
<section id="what-do-ugs-know" class="level3">
<h3 class="anchored" data-anchor-id="what-do-ugs-know">What do UGs know?</h3>
<p>Data visualisation with {ggplot2} is explicitly introduced near the end of the first term of Year 1 at Sussex, and practiced throughout the second term. In Year 2, there is less focus on constructing plots from scratch, and instead students are taught how to get a basic plot pre-made and then modify it using their {ggplot2} skills.</p>
<p>This tutorial includes essentially everything students are taught in Year 1, with a variety of extRas sprinkled in. In the next tutorial, we will look at the plots they are taught in Year 2, which accompany the relevant analysis (e.g.&nbsp;ANOVA, mediation, and moderation).</p>
</section>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<section id="packages" class="level3">
<h3 class="anchored" data-anchor-id="packages">Packages</h3>
<p>We will be relying heavily on the {ggplot2} package, naturally, which is part of {tidyverse}. You can load {ggplot2} by itself, but since we will also make use of some other {tidyverse} functions, it’s probably most efficient to simply load {tidyverse}.</p>
<p>We will also be using {ggrain} for raincloud plots and {viridis} for colour palettes.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Load the packages.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="Non-Explicit Function Calls">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Non-Explicit Function Calls
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You may notice that I will abandon my usual explicit function style for {ggplot2} functions - so, for example, instead of <code>ggplot2::ggplot(ggplot2::aes(...))</code> I’ll just write <code>ggplot(aes())</code>. In this case, it is <em>much</em> easier to simply load the {ggplot2} package and drop the package call, than to type the same package name over and over <em>and over</em>. It also makes the chonky {ggplot2} code a lot easier to read!</p>
</div>
</div>
</div>
</section>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<p>Today we’re continuing to work with the dataset courtesy of fantastic Sussex colleague <a href="https://www.jennyterry.co.uk/">Jenny Terry</a>. This dataset contains real data about statistics and maths anxiety. For these latter two tutorials, I’ve created averaged scores for each subscale, and dropped the individual items.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Read in the dataset and save it in a new object, <code>anx_score_data</code>.</p>
<p>On the Cloud, you can read in this dataset from the <code>data</code> folder using <code>here::here()</code>.</p>
<p>Elsewhere, you can download the dataset, or copy the dataset URL, from the <a href="../../../data_workbooks.qmd">Data and Workbooks page</a>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Read in from file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/anx_scores_data.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Read in from URL:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>anx_data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/drmankin/practicum/master/data/anx_scores_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="codebook" class="level4">
<h4 class="anchored" data-anchor-id="codebook">Codebook</h4>
<p>There’s quite a bit in this dataset, so you will need to refer to the codebook below for a description of all the variables.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Dataset Info Recap">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dataset Info Recap
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This study explored the difference between maths and statistics anxiety, widely assumed to be different constructs. Participants completed the Statistics Anxiety Rating Scale (<a href="https://explore.bps.org.uk/content/bpsptr/24/2/101">STARS</a>) and Maths Anxiety Rating Scale - Revised (<a href="https://journals.sagepub.com/doi/10.1177/001316448204200218">R-MARS</a>), as well as modified versions, the STARS-M and R-MARS-S. In the modified versions of the scales, references to statistics and maths were swapped; for example, the STARS item “Studying for an examination in a statistics course” became the STARS-M item “Studying for an examination in a maths course”; and the R-MARS item “Walking into a maths class” because the R-MARS-S item “Walking into a statistics class”.</p>
<p>Participants also completed the State-Trait Inventory for Cognitive and Somatic Anxiety (<a href="https://www.cambridge.org/core/journals/behavioural-and-cognitive-psychotherapy/article/abs/distinguishing-cognitive-and-somatic-dimensions-of-state-and-trait-anxiety-development-and-validation-of-the-statetrait-inventory-for-cognitive-and-somatic-anxiety-sticsa/78FDDC5BCDE9D4164434AC10E83DCEF3?utm_campaign=shareaholic&amp;utm_medium=copy_link&amp;utm_source=bookmark">STICSA</a>). They completed the state anxiety items twice: once before, and once after, answering a set of five MCQ questions. These MCQ questions were either about maths, or about statistics; each participant only saw one of the two MCQ conditions.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>For learning purposes, I’ve randomly generated some additional variables to add to the dataset containing info on distribution channel, consent, gender, and age. Especially for the consent variable, don’t worry: all the participants in this dataset did consent to the original study. I’ve simulated and added this variable in later to practice removing participants.</p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Description</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">Unique ID code</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">distribution</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">Channel through which the study was completed, either as a preview (before real data collection) or anonymous genuine responses. Note that this variable has been randomly generated and does NOT reflect genuine responses.</td>
<td style="text-align: left;">"preview" or "anonymous"</td>
</tr>
<tr class="odd">
<td style="text-align: left;">consent</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">Whether the participant read and consented to participate. Note that this variable has been randomly generated and does NOT reflect genuine responses; all participants in this dataset did originally consent to participate.</td>
<td style="text-align: left;">"Yes" or "No"</td>
</tr>
<tr class="even">
<td style="text-align: left;">gender</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">Gender identity. Note that this variable has been randomly generated and does NOT reflect genuine responses.</td>
<td style="text-align: left;">"female", "male", "non-binary", or "other/pnts". "pnts" is an abbreviation for "Prefer not to say".</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Age in years. Note that this variable has been randomly generated and does NOT reflect genuine responses.</td>
<td style="text-align: left;">18 - 99</td>
</tr>
<tr class="even">
<td style="text-align: left;">mcq</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">Independent variable for MCQ question condition, whether the participant saw MCQ questions about mathematics or statistics.</td>
<td style="text-align: left;">"maths" or "stats"</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stars_test_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Test Anxiety subscale of the Statistics Anxiety Rating Scale (STARS)</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="even">
<td style="text-align: left;">stars_int_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Interpretation Anxiety subscale of the Statistics Anxiety Rating Scale (STARS)</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stars_help_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Asking for Help subscale of the Statistics Anxiety Rating Scale (STARS)</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="even">
<td style="text-align: left;">stars_m_test_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Test Anxiety subscale of the Statistics Anxiety Rating Scale - Maths (STARS-M), a modified version of the STARS with all references to maths replaced with statistics.</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stars_m_int_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Interpretation Anxiety subscale of the Statistics Anxiety Rating Scale - Maths (STARS-M), a modified version of the STARS with all references to maths replaced with statistics.</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="even">
<td style="text-align: left;">stars_m_help_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Asking for Help subscale of the Statistics Anxiety Rating Scale - Maths (STARS-M), a modified version of the STARS with all references to maths replaced with statistics.</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rmars_test_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Test Anxiety subscale of the Revised Maths Anxiety Rating Scale (R-MARS)</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="even">
<td style="text-align: left;">rmars_num_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Numerical Task Anxiety subscale of the Revised Maths Anxiety Rating Scale (R-MARS)</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rmars_course_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Course Anxiety subscale of the Revised Maths Anxiety Rating Scale (R-MARS)</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="even">
<td style="text-align: left;">rmars_s_test_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Test Anxiety subscale of the Revised Maths Anxiety Rating Scale - Statistics (R-MARS-S), a modified version of the MARS with all references to maths replaced with statistics.</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rmars_s_num_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Numerical Anxiety subscale of the Revised Maths Anxiety Rating Scale - Statistics (R-MARS-S), a modified version of the MARS with all references to maths replaced with statistics.</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="even">
<td style="text-align: left;">rmars_s_course_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Course Anxiety subscale of the Revised Maths Anxiety Rating Scale - Statistics (R-MARS-S), a modified version of the MARS with all references to maths replaced with statistics.</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sticsa_trait_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Trait Anxiety subscale of the State-Trait Inventory for Cognitive and Somatic Anxiety.</td>
<td style="text-align: left;">1 (not at all) to 4 (very much so)</td>
</tr>
<tr class="even">
<td style="text-align: left;">sticsa_pre_state_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the State Anxiety subscale of the State-Trait Inventory for Cognitive and Somatic Anxiety, pre-MCQ.</td>
<td style="text-align: left;">1 (not at all) to 4 (very much so)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sticsa_post_state_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the State Anxiety subscale of the State-Trait Inventory for Cognitive and Somatic Anxiety, post-MCQ.</td>
<td style="text-align: left;">1 (not at all) to 4 (very much so)</td>
</tr>
<tr class="even">
<td style="text-align: left;">mcq_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Total (summed) score on the MCQ questions.</td>
<td style="text-align: left;">0 (all incorrect) to 5 (all correct)</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>If you have some experience with R, you are welcome to instead use another dataset that you are familiar with or are keen to explore. However, remember that anything you upload to the training Posit Cloud workspace is visible to all workspace admins, so keep GDPR in mind.</p>
<p>&nbsp;</p>
</section>
</section>
</section>
<section id="grammar-of-graphics" class="level2">
<h2 class="anchored" data-anchor-id="grammar-of-graphics">Grammar of Graphics</h2>
<p>The {ggplot} package is a bit of a universe in its own right. Like R itself, it’s extremely powerful and versatile, and that also means there are a near-endless variety of things you could do and different ways to do them.</p>
<p>What we’ll cover in this tutorial is the core structure of building data visualisations in {ggplot2}, so that you have a solid base to build your own designs on. No matter what you’re trying to do, there’s nearly always a blog post, help document, or Stack Overflow post titled “How to do [whatever] in ggplot” to point you in the right direction!</p>
<section id="layers" class="level3">
<h3 class="anchored" data-anchor-id="layers">Layers</h3>
<p>Plots in {ggplot2} are built in layers. Each layer adds to or changes something about the plot; these can be big elements, like determining the type of plot to create, to small details like editing axis labels or changing colours. In {ggplot2}, each layer is a function.</p>
<p>If it helps, you can think of layers like <a href="https://www.instagram.com/reel/CpTb7oCJ5da/?utm_source=ig_web_button_share_sheet">different colours in a linocut print</a>. Each additional layer of colour adds a bit more to the overall picture, building up from big blocks of colour to small details.</p>
<p>To build a visualisation in {ggplot2}, it’s a good idea to build your plot in the same way, from big picture to small detail. As we’ll see, I usually build plot layers like this:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  aesthetics_mapping <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  choose_type_of_plot <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  add_more_elements <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  edit_labels_or_colours <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  apply_a_theme</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>These are guidelines, but the general =&gt; specific flow is for a good reason: <strong>layers are evaluated from top to bottom</strong>. So, it’s best to get the big pieces in place first, then fine-tune, than to have those fiddly bits overwritten by a major change at the end of the code.</p>
<p>Notice as well that <strong>layers are added to a plot object with <code>+</code> and NOT with <code>|&gt;</code></strong>. This is specific to {ggplot2} (AFAIK!) and is easy to forget, but don’t worry - it’s such a common thing that {ggplot2} has a very friendly error message for fixing it.</p>
<div class="callout callout-style-default callout-warning callout-titled" title="Error Watch: `mapping` must be created by `aes()`">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Error Watch: <code>mapping</code> must be created by <code>aes()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The actual error that pops up when you use a pipe instead of <code>+</code> isn’t super transparent. However, there is a very friendly reminder directly underneath to nudge you in the right direction. It’s a good reason to always read the error message in full!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mcq_sum)) <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `geom_histogram()`:
! `mapping` must be created by `aes()`.
ℹ Did you use `%&gt;%` or `|&gt;` instead of `+`?</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="mapping" class="level3">
<h3 class="anchored" data-anchor-id="mapping">Mapping</h3>
<p>As we saw in the error just above, mapping is created with <code>aes()</code>. This little function defines the <em>aes</em>thetics of the plot - in other words, this is how you tell R what data you want it to plot. We’ll use the following general format to set up a plot:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dataset_name <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable_on_x_axis, <span class="at">y =</span> variable_on_y_axis, ...))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>...</code> takes additional arguments to add things like colour and fill.</p>
</section>
<section id="geoms-etc." class="level3">
<h3 class="anchored" data-anchor-id="geoms-etc.">Geoms, etc.</h3>
<p>So, how do we actually add layers? There are several common types of functions with shared prefixes that do particular things. We’ll meet lots of examples of them just below, but as a quick reference for some of the more common function types:</p>
<ul>
<li><code>geom_*()</code>: Draw <em>geom</em>etric objects to represent the data.</li>
<li><code>stat_*()</code>: Add elements to the plot calculated with <em>stat</em>istical functions.</li>
<li><code>scale_*()</code>, <code>labs()</code>, and <code>lims()</code>: Adjust the appearance of the axes (labels, title, limits, etc.) or quickly adjust the <em>lab</em>els or <em>lim</em>its only</li>
<li><code>guide_*()</code>: Make adjustments to the scales or to other interpretational elements of the plot (such as legends for categories)</li>
<li><code>theme_*()</code>: Apply a pre-made theme to the entire plot</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>See the <a href="https://ggplot2.tidyverse.org/reference/">{ggplot} reference documentation</a> for a comprehensive list and detailed guide to these functions and more.</p>
</div>
</div>
<p>Right, the best way to get a handle on these functions is to start building plots! So let’s jump in.</p>
<p>&nbsp;</p>
</section>
</section>
<section id="histograms-and-density-plots" class="level2">
<h2 class="anchored" data-anchor-id="histograms-and-density-plots">Histograms and Density Plots</h2>
<p>Let’s start with a histogram, a very common type of visualisation that represents the frequency of each value in a variable. We’re going to first create a histogram of the <code>mcq_score</code> variable in the <code>anx_scores_data</code> dataset.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Follow along with the instructions below to build your own plot as we go. Feel free to tweak details like colour and labels as you like.</p>
</div>
</div>
<p>For a basic histogram, we need three elements. First, pipe in the data; then, set the aesthetics; then, use <code>geom_histogram()</code> to draw the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mcq_score)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hooray! The downside is… that’s pretty ugly. For a quick glance this isn’t really any better than <code>hist()</code>. So - let’s make it better by doing the following:</p>
<ol type="1">
<li>Adjusting the binwidth to present the values more sensibly</li>
<li>Adding colour and fill</li>
<li>Adjusting the axis labels and tick marks</li>
<li>Applying a theme.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you haven’t yet, you might want to pull up the help documentation for <code>geom_histogram()</code> to get a look at the options available.</p>
</div>
</div>
<section id="adjusting-binwidth" class="level3">
<h3 class="anchored" data-anchor-id="adjusting-binwidth">Adjusting Binwidth</h3>
<p>The message from the previous output gave us a helpful tip to deal with those weird bins:</p>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p>So, let’s use <code>binwidth =</code> to choose a more appropriate value for this data. Because these are the summed MCQ scores, the values can only be <strong>whole numbers</strong> between 0 and 5. So, let’s try setting the binwidth to 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mcq_score)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is better, but now we’ve got some new problems: one, the automatically generated axis now only has 0, 2, and 4, when it would be better to have 0 - 5; and the histogram now looks like quite a shapeless lump. Let’s work on the colour first.</p>
</section>
<section id="colour-and-fill-manual" class="level3">
<h3 class="anchored" data-anchor-id="colour-and-fill-manual">Colour and Fill Manual</h3>
<p>It’s not obvious from the help documentation unfortunately (just mentioned in passing under the <code>...</code> argument) but this function, and most <code>geom_*()</code> functions!, will take the arguments <code>colour</code> and <code>fill</code>. For this, we give each argument a string with a colour name in it. You can just guess at colour names until you find one you like, or you can refer to this <a href="https://www.datanovia.com/en/blog/awesome-list-of-657-r-color-names/">massive list of R colour names</a> to pick one.</p>
<p>Here’s an example of how that looks with some very boring colours, that’s a bit easier on the eyes than the dark grey lump above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mcq_score)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colour =</span> <span class="st">"black"</span>, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"lightgray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This would be fine for formal reporting, but we’re going to be all about the aesthetics today and those colours are downright dreary. Let’s instead borrow from the <a href="https://www.sussex.ac.uk/brand/designers/colour">Sussex official colour palette</a> to set custom colours. I’m choosing “Sussex Flint”<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> for the outline colour and “Deep Aquamarine” for the fill, but feel free to choose whatever you like. You could also use <a href="https://www.google.com/search?q=colour+picker">an online colour picker like this one</a> to choose any hex code for any colour you can dream of to use!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mcq_score)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colour =</span> <span class="st">"#003b49"</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"#007a78"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What we can see here is that the “colour” in this case is the outline of the bars; and the “fill” is the colour inside the bars. This system is fairly consistent across geoms, but you may need to mix up the “colour” vs “fill” arguments depending on the exact effect you want.</p>
<p>With that sorted, let’s move onto the axis and ticks.</p>
</section>
<section id="adjusting-axes-with-scale_" class="level3">
<h3 class="anchored" data-anchor-id="adjusting-axes-with-scale_">Adjusting Axes with <code>scale_*()</code></h3>
<p>You can use the <code>labs()</code> shortcut to adjust labels easily, but personally I prefer to go the long way round (surprise lol) and use the <code>scale_*()</code> family instead. These functions have specific names depending on which axis scale you want to adjust, and the way that data is measured. In this case I want to adjust the <em>x</em>-axis and the data is continuous<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, so the function I need is <code>scale_x_continuous()</code>.</p>
<p>The advantage of going through the extra trouble to use the <code>scale_*()</code> functions is that they allow you to adjust everything about that scale at once. So, I can use the arguments for <code>scale_x_continuous()</code> to change the axis label with <code>name =</code>, the breaks with <code>breaks =</code>, the limits with <code>limits =</code> …well, I’m sure you get the idea!</p>
<p>I can also do the same with the <em>y</em> axis, using (as you might have guessed) <code>scale_y_continuous()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mcq_score)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colour =</span> <span class="st">"#003b49"</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"#007a78"</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Total MCQ Score (out of 5)"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">to =</span> <span class="dv">120</span>, </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">by =</span> <span class="dv">20</span>),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">120</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If you have a look at the argument to <code>breaks</code> and <code>limits</code>, you can see why we took some time early on learning about numeric vectors. <code>breaks</code> requires a vector of values indicating where the breaks should be, and <code>limits</code> requires a vector of two values, one for the minimum limit and the other for the maximum limit.</p>
<p>I’ve also used a new function, <code>seq()</code>, to create the <em>y</em>-axis breaks. This handy little base-R function generates a <em>seq</em>uence of values, given the first and last values in the sequence and how much you want to increment by. I’ve asked it to start at 0, end at 120, and increment by 20 each time, instead of typing <code>c(0, 20, 40, ...)</code> myself.</p>
</section>
<section id="adding-a-theme" class="level3">
<h3 class="anchored" data-anchor-id="adding-a-theme">Adding a Theme</h3>
<p>That’s actually looking pretty snazzy at this point. The last thing we might want to do for now is to apply a theme. The default is <code>theme_grey()</code>, which I’m not a fan of. If you type <code>theme_</code> into a code chunk, you’ll get a list of options to try out and find one you like.</p>
<p>However, I’m going to go straight the most extRa option, namely: <a href="https://frederikaust.com/papaja_man/reporting.html#r-generated-figures">an inbuilt APA-style theme from the {papaja} package</a>, <code>papaja::theme_apa()</code>. Because I like how it looks, I’ll use the <code>box = TRUE</code> argument to draw a box around the whole plot. Teal (excuse me, <em>Deep Aquamarine</em>) isn’t a particularly APA-standard colour, but I like it, so there.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mcq_score)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colour =</span> <span class="st">"#003b49"</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"#007a78"</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Total MCQ Score (out of 5)"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">to =</span> <span class="dv">120</span>, </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">by =</span> <span class="dv">20</span>),</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There you have it! That’s looking pretty nice, I think.</p>
<p>To lock it in, let’s get some practice using these functions with a minimally different example.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create a density plot of the <code>rmars_s_test_score</code> variable (or another continuous variable in the dataset of your choosing). For a finished plot, make sure you:</p>
<ul>
<li>Choose colours for your plot.</li>
<li>Adjust the labels, breaks, and limits as necessary.</li>
<li>Add a theme.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can start the same way we did above, just switching out our previous variable in <code>aes()</code> for the new one and changing <code>geom_histogram()</code> to <code>geom_density()</code>. We can drop the <code>binwidth</code> argument since it isn’t relevant anymore. I’ve left the colours in because they work the same way (and look nice!).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rmars_s_test_score)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">colour =</span> <span class="st">"#003b49"</span>, <span class="at">fill =</span> <span class="st">"#007a78"</span>)  <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From here we might want to do a bit more tweaking to get the axes right, using the same functions as we did for the histogram.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rmars_s_test_score)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">colour =</span> <span class="st">"#003b49"</span>, <span class="at">fill =</span> <span class="st">"#007a78"</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Mean Score on the R-MARS-S Test Subscale"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Probability Density"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="facet-wrap" class="level3">
<h3 class="anchored" data-anchor-id="facet-wrap">Facet Wrap</h3>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Note</em>: This gets a bit into the weeds, so if you’d like to skip this section, feel free to skip down to <a href="../../tutorials/archive_autumn_2023/07_dataviz.html#barplots">the next type of plot</a>.</p>
</div>
</div>
<p>Before we move on, a useful option here would be to visualise the MCQ scores for the two MCQ groups side by side, since this was our independent manipulation. To do this, we can use the <code>facet_wrap()</code> function to split our single plot into two based on a grouping variable - here, <code>mcq</code>. I’ve also changed the settings on the <em>y</em>-axis to adjust to the new scale.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mcq_score)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colour =</span> <span class="st">"#003b49"</span>, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"#007a78"</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Total MCQ Score (out of 5)"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">to =</span> <span class="dv">70</span>, </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">by =</span> <span class="dv">10</span>),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">70</span>)) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mcq) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There are a few more things I’d like to tweak about this plot. First, I’d love to have the maths and stats groups in different colours to differentiate them visually. Second, I want to format the “maths” and “stats” labels at the top of the plot.</p>
<p>To do the first, I’m going to actually go back up to the <code>aes()</code> mapping function and add <code>mcq</code> as the variable that determines both colour and fill, and drop the <code>color</code> and <code>fill</code> arguments from <code>geom_histogram()</code>.</p>
<p>Next, I’m going to add a vector of names and values to the <code>labeller = as_labeller(...)</code> argument of <code>facet_wrap()</code>, which adds nice labels above each mini-plot.</p>
<p>Finally, I use two more <code>scale_*()</code> functions to set the colour and fill, with the order of the colours in the same order as the values of the <code>mcq</code> variable. The <code>guide = "none"</code> argument removes the automatically generated legend, which I didn’t need because I added the labels.</p>
<p>Whew! That’s it - here’s the final product.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mcq_score, <span class="at">colour =</span> mcq, <span class="at">fill =</span> mcq)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Total MCQ Score (out of 5)"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">to =</span> <span class="dv">70</span>, </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">by =</span> <span class="dv">10</span>),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">70</span>)) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mcq, </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="st">`</span><span class="at">maths</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Maths MCQs"</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>                 <span class="st">`</span><span class="at">stats</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Stats MCQs"</span>))) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#003b49"</span>, <span class="st">"#1b365d"</span>), </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#007a78"</span>, <span class="st">"#7da1c4"</span>), </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Checking In">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Checking In
</div>
</div>
<div class="callout-body-container callout-body">
<p>How are you doing? This is a bunch of new information, so don’t worry if you feel a bit overwhelmed. Honestly when I am constructing plots, a good portion of the time I spend to make them is either 1) digging back through my own previous documents to lift code I’ve already written or 2) searching online for help posts to figure out how to do things! I didn’t know how to do basically any of the formatting for the facet-wrapped plot above, and it took me about an hour of testing and searching to figure it out. I hope having these templates saves you a bit of time in the future.</p>
</div>
</div>
<p>&nbsp;</p>
</section>
</section>
<section id="barplots" class="level2">
<h2 class="anchored" data-anchor-id="barplots">Barplots</h2>
<p>With some key ideas for building plots under our belts, let’s have a look at creating visualisations of categorical data.</p>
<p>To start with, we’ll need some (preferably interesting) categorical data to work with. Let’s begin by creating a categorical variable out of one of our continuous variables to practice what we covered in the previous tutorial. (This kind of operation is often not recommended for real analysis, but we’re learning so, y’know, it’s fine.)</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create a new variable in the dataset, <code>stars_help_cat</code>, that contains either “low” for people who scored below 3 on the STARS Asking for Help subscale, or “high” for people who scored 3 or above. Make sure to save your changes back to the dataset.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>First, let’s use <code>case_when()</code> to create our variable, and check whether everything looks good using the <code>.keep = "used"</code> argument in <code>mutate()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">stars_help_cat =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>      stars_help_score <span class="sc">&lt;</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"low"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>      stars_help_score <span class="sc">&gt;=</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> <span class="cn">NA</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.keep =</span> <span class="st">"used"</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["stars_help_score"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["stars_help_cat"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"2.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"3.000000","2":"high"},{"1":"2.750000","2":"low"},{"1":"2.500000","2":"low"},{"1":"4.250000","2":"high"},{"1":"2.000000","2":"low"},{"1":"2.250000","2":"low"},{"1":"2.750000","2":"low"},{"1":"3.000000","2":"high"},{"1":"3.000000","2":"high"},{"1":"3.500000","2":"high"},{"1":"2.500000","2":"low"},{"1":"2.250000","2":"low"},{"1":"5.000000","2":"high"},{"1":"2.750000","2":"low"},{"1":"3.000000","2":"high"},{"1":"1.250000","2":"low"},{"1":"2.250000","2":"low"},{"1":"4.250000","2":"high"},{"1":"3.250000","2":"high"},{"1":"2.250000","2":"low"},{"1":"2.250000","2":"low"},{"1":"1.750000","2":"low"},{"1":"1.500000","2":"low"},{"1":"1.000000","2":"low"},{"1":"1.250000","2":"low"},{"1":"3.500000","2":"high"},{"1":"2.250000","2":"low"},{"1":"5.000000","2":"high"},{"1":"3.750000","2":"high"},{"1":"3.250000","2":"high"},{"1":"4.250000","2":"high"},{"1":"2.000000","2":"low"},{"1":"5.000000","2":"high"},{"1":"3.500000","2":"high"},{"1":"3.750000","2":"high"},{"1":"2.500000","2":"low"},{"1":"2.500000","2":"low"},{"1":"2.000000","2":"low"},{"1":"2.250000","2":"low"},{"1":"4.250000","2":"high"},{"1":"4.000000","2":"high"},{"1":"2.000000","2":"low"},{"1":"2.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"3.333333","2":"high"},{"1":"4.500000","2":"high"},{"1":"1.750000","2":"low"},{"1":"3.500000","2":"high"},{"1":"3.250000","2":"high"},{"1":"1.750000","2":"low"},{"1":"3.250000","2":"high"},{"1":"4.500000","2":"high"},{"1":"1.500000","2":"low"},{"1":"2.000000","2":"low"},{"1":"3.000000","2":"high"},{"1":"1.000000","2":"low"},{"1":"4.000000","2":"high"},{"1":"1.750000","2":"low"},{"1":"3.750000","2":"high"},{"1":"4.250000","2":"high"},{"1":"5.000000","2":"high"},{"1":"2.750000","2":"low"},{"1":"2.000000","2":"low"},{"1":"2.500000","2":"low"},{"1":"3.250000","2":"high"},{"1":"5.000000","2":"high"},{"1":"1.500000","2":"low"},{"1":"4.750000","2":"high"},{"1":"4.000000","2":"high"},{"1":"2.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"3.500000","2":"high"},{"1":"1.500000","2":"low"},{"1":"3.250000","2":"high"},{"1":"1.000000","2":"low"},{"1":"3.250000","2":"high"},{"1":"3.250000","2":"high"},{"1":"3.500000","2":"high"},{"1":"2.000000","2":"low"},{"1":"2.000000","2":"low"},{"1":"2.250000","2":"low"},{"1":"2.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"3.500000","2":"high"},{"1":"3.000000","2":"high"},{"1":"2.750000","2":"low"},{"1":"3.000000","2":"high"},{"1":"2.000000","2":"low"},{"1":"2.500000","2":"low"},{"1":"2.250000","2":"low"},{"1":"2.000000","2":"low"},{"1":"1.500000","2":"low"},{"1":"3.000000","2":"high"},{"1":"1.000000","2":"low"},{"1":"3.250000","2":"high"},{"1":"4.000000","2":"high"},{"1":"2.750000","2":"low"},{"1":"3.000000","2":"high"},{"1":"1.750000","2":"low"},{"1":"2.000000","2":"low"},{"1":"2.750000","2":"low"},{"1":"3.000000","2":"high"},{"1":"2.500000","2":"low"},{"1":"1.750000","2":"low"},{"1":"1.000000","2":"low"},{"1":"5.000000","2":"high"},{"1":"4.500000","2":"high"},{"1":"3.000000","2":"high"},{"1":"2.000000","2":"low"},{"1":"1.250000","2":"low"},{"1":"1.750000","2":"low"},{"1":"3.500000","2":"high"},{"1":"1.000000","2":"low"},{"1":"3.250000","2":"high"},{"1":"2.000000","2":"low"},{"1":"2.750000","2":"low"},{"1":"2.750000","2":"low"},{"1":"1.500000","2":"low"},{"1":"2.000000","2":"low"},{"1":"3.250000","2":"high"},{"1":"1.500000","2":"low"},{"1":"3.250000","2":"high"},{"1":"4.000000","2":"high"},{"1":"2.250000","2":"low"},{"1":"2.500000","2":"low"},{"1":"4.250000","2":"high"},{"1":"1.000000","2":"low"},{"1":"2.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"1.750000","2":"low"},{"1":"2.250000","2":"low"},{"1":"3.250000","2":"high"},{"1":"2.000000","2":"low"},{"1":"3.750000","2":"high"},{"1":"3.500000","2":"high"},{"1":"4.750000","2":"high"},{"1":"4.000000","2":"high"},{"1":"2.250000","2":"low"},{"1":"5.000000","2":"high"},{"1":"3.000000","2":"high"},{"1":"4.250000","2":"high"},{"1":"3.750000","2":"high"},{"1":"1.000000","2":"low"},{"1":"1.750000","2":"low"},{"1":"4.750000","2":"high"},{"1":"2.000000","2":"low"},{"1":"2.500000","2":"low"},{"1":"4.750000","2":"high"},{"1":"2.250000","2":"low"},{"1":"3.250000","2":"high"},{"1":"5.000000","2":"high"},{"1":"1.500000","2":"low"},{"1":"4.750000","2":"high"},{"1":"2.500000","2":"low"},{"1":"4.250000","2":"high"},{"1":"2.500000","2":"low"},{"1":"4.000000","2":"high"},{"1":"2.000000","2":"low"},{"1":"2.000000","2":"low"},{"1":"3.750000","2":"high"},{"1":"3.000000","2":"high"},{"1":"1.500000","2":"low"},{"1":"3.000000","2":"high"},{"1":"2.750000","2":"low"},{"1":"2.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"2.000000","2":"low"},{"1":"2.750000","2":"low"},{"1":"2.000000","2":"low"},{"1":"1.500000","2":"low"},{"1":"2.250000","2":"low"},{"1":"3.500000","2":"high"},{"1":"3.250000","2":"high"},{"1":"3.750000","2":"high"},{"1":"4.250000","2":"high"},{"1":"2.750000","2":"low"},{"1":"4.000000","2":"high"},{"1":"4.000000","2":"high"},{"1":"1.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"1.250000","2":"low"},{"1":"4.500000","2":"high"},{"1":"2.000000","2":"low"},{"1":"3.000000","2":"high"},{"1":"1.500000","2":"low"},{"1":"3.500000","2":"high"},{"1":"3.250000","2":"high"},{"1":"2.750000","2":"low"},{"1":"2.500000","2":"low"},{"1":"1.250000","2":"low"},{"1":"2.750000","2":"low"},{"1":"2.750000","2":"low"},{"1":"4.500000","2":"high"},{"1":"1.750000","2":"low"},{"1":"2.000000","2":"low"},{"1":"2.500000","2":"low"},{"1":"1.000000","2":"low"},{"1":"4.750000","2":"high"},{"1":"4.250000","2":"high"},{"1":"1.000000","2":"low"},{"1":"1.250000","2":"low"},{"1":"3.250000","2":"high"},{"1":"2.000000","2":"low"},{"1":"2.750000","2":"low"},{"1":"1.250000","2":"low"},{"1":"4.000000","2":"high"},{"1":"1.250000","2":"low"},{"1":"4.500000","2":"high"},{"1":"1.750000","2":"low"},{"1":"4.000000","2":"high"},{"1":"1.750000","2":"low"},{"1":"2.000000","2":"low"},{"1":"5.000000","2":"high"},{"1":"3.000000","2":"high"},{"1":"1.750000","2":"low"},{"1":"4.250000","2":"high"},{"1":"2.500000","2":"low"},{"1":"2.000000","2":"low"},{"1":"2.000000","2":"low"},{"1":"3.750000","2":"high"},{"1":"2.000000","2":"low"},{"1":"3.000000","2":"high"},{"1":"4.000000","2":"high"},{"1":"4.250000","2":"high"},{"1":"4.500000","2":"high"},{"1":"1.500000","2":"low"},{"1":"4.500000","2":"high"},{"1":"2.750000","2":"low"},{"1":"5.000000","2":"high"},{"1":"4.250000","2":"high"},{"1":"3.000000","2":"high"},{"1":"2.500000","2":"low"},{"1":"1.500000","2":"low"},{"1":"2.000000","2":"low"},{"1":"2.750000","2":"low"},{"1":"3.500000","2":"high"},{"1":"3.500000","2":"high"},{"1":"3.000000","2":"high"},{"1":"4.000000","2":"high"},{"1":"2.250000","2":"low"},{"1":"3.750000","2":"high"},{"1":"4.250000","2":"high"},{"1":"2.500000","2":"low"},{"1":"2.250000","2":"low"},{"1":"3.250000","2":"high"},{"1":"4.000000","2":"high"},{"1":"3.000000","2":"high"},{"1":"4.000000","2":"high"},{"1":"1.250000","2":"low"},{"1":"2.750000","2":"low"},{"1":"1.750000","2":"low"},{"1":"2.750000","2":"low"},{"1":"3.500000","2":"high"},{"1":"2.500000","2":"low"},{"1":"3.000000","2":"high"},{"1":"4.250000","2":"high"},{"1":"3.000000","2":"high"},{"1":"3.000000","2":"high"},{"1":"3.000000","2":"high"},{"1":"1.000000","2":"low"},{"1":"4.750000","2":"high"},{"1":"3.250000","2":"high"},{"1":"2.750000","2":"low"},{"1":"2.250000","2":"low"},{"1":"4.000000","2":"high"},{"1":"1.000000","2":"low"},{"1":"4.000000","2":"high"},{"1":"2.750000","2":"low"},{"1":"2.750000","2":"low"},{"1":"3.250000","2":"high"},{"1":"2.000000","2":"low"},{"1":"2.000000","2":"low"},{"1":"2.000000","2":"low"},{"1":"3.000000","2":"high"},{"1":"4.000000","2":"high"},{"1":"3.500000","2":"high"},{"1":"4.500000","2":"high"},{"1":"4.750000","2":"high"},{"1":"4.000000","2":"high"},{"1":"4.750000","2":"high"},{"1":"2.000000","2":"low"},{"1":"1.500000","2":"low"},{"1":"4.250000","2":"high"},{"1":"1.000000","2":"low"},{"1":"3.500000","2":"high"},{"1":"1.250000","2":"low"},{"1":"1.000000","2":"low"},{"1":"4.000000","2":"high"},{"1":"1.000000","2":"low"},{"1":"1.250000","2":"low"},{"1":"1.750000","2":"low"},{"1":"2.000000","2":"low"},{"1":"3.750000","2":"high"},{"1":"5.000000","2":"high"},{"1":"2.000000","2":"low"},{"1":"2.000000","2":"low"},{"1":"3.000000","2":"high"},{"1":"1.000000","2":"low"},{"1":"2.750000","2":"low"},{"1":"3.000000","2":"high"},{"1":"1.250000","2":"low"},{"1":"3.750000","2":"high"},{"1":"3.666667","2":"high"},{"1":"3.500000","2":"high"},{"1":"3.750000","2":"high"},{"1":"3.000000","2":"high"},{"1":"2.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"3.250000","2":"high"},{"1":"1.000000","2":"low"},{"1":"3.000000","2":"high"},{"1":"2.750000","2":"low"},{"1":"2.500000","2":"low"},{"1":"4.000000","2":"high"},{"1":"4.250000","2":"high"},{"1":"4.000000","2":"high"},{"1":"4.750000","2":"high"},{"1":"5.000000","2":"high"},{"1":"3.000000","2":"high"},{"1":"1.250000","2":"low"},{"1":"1.750000","2":"low"},{"1":"2.750000","2":"low"},{"1":"2.000000","2":"low"},{"1":"3.500000","2":"high"},{"1":"1.500000","2":"low"},{"1":"3.500000","2":"high"},{"1":"3.000000","2":"high"},{"1":"3.000000","2":"high"},{"1":"2.250000","2":"low"},{"1":"3.250000","2":"high"},{"1":"4.000000","2":"high"},{"1":"3.250000","2":"high"},{"1":"4.750000","2":"high"},{"1":"2.500000","2":"low"},{"1":"1.000000","2":"low"},{"1":"2.000000","2":"low"},{"1":"2.500000","2":"low"},{"1":"2.000000","2":"low"},{"1":"1.750000","2":"low"},{"1":"1.750000","2":"low"},{"1":"4.250000","2":"high"},{"1":"4.750000","2":"high"},{"1":"1.500000","2":"low"},{"1":"3.750000","2":"high"},{"1":"2.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"3.000000","2":"high"},{"1":"3.000000","2":"high"},{"1":"3.000000","2":"high"},{"1":"2.750000","2":"low"},{"1":"2.000000","2":"low"},{"1":"2.250000","2":"low"},{"1":"4.250000","2":"high"},{"1":"5.000000","2":"high"},{"1":"2.000000","2":"low"},{"1":"4.000000","2":"high"},{"1":"3.250000","2":"high"},{"1":"4.000000","2":"high"},{"1":"2.750000","2":"low"},{"1":"1.500000","2":"low"},{"1":"3.250000","2":"high"},{"1":"3.250000","2":"high"},{"1":"3.250000","2":"high"},{"1":"1.750000","2":"low"},{"1":"3.000000","2":"high"},{"1":"1.500000","2":"low"},{"1":"2.000000","2":"low"},{"1":"1.500000","2":"low"},{"1":"1.500000","2":"low"},{"1":"4.250000","2":"high"},{"1":"2.750000","2":"low"},{"1":"3.000000","2":"high"},{"1":"4.000000","2":"high"},{"1":"3.000000","2":"high"},{"1":"4.000000","2":"high"},{"1":"4.750000","2":"high"},{"1":"1.000000","2":"low"},{"1":"3.500000","2":"high"},{"1":"2.000000","2":"low"},{"1":"1.750000","2":"low"},{"1":"2.750000","2":"low"},{"1":"2.000000","2":"low"},{"1":"4.000000","2":"high"},{"1":"1.500000","2":"low"},{"1":"4.000000","2":"high"},{"1":"5.000000","2":"high"},{"1":"2.250000","2":"low"},{"1":"4.000000","2":"high"},{"1":"2.250000","2":"low"},{"1":"2.750000","2":"low"},{"1":"3.000000","2":"high"},{"1":"4.250000","2":"high"},{"1":"3.000000","2":"high"},{"1":"2.250000","2":"low"},{"1":"4.000000","2":"high"},{"1":"3.750000","2":"high"},{"1":"1.500000","2":"low"},{"1":"4.500000","2":"high"},{"1":"3.750000","2":"high"},{"1":"4.250000","2":"high"},{"1":"3.500000","2":"high"},{"1":"1.750000","2":"low"},{"1":"3.500000","2":"high"},{"1":"4.000000","2":"high"},{"1":"2.500000","2":"low"},{"1":"4.000000","2":"high"},{"1":"5.000000","2":"high"},{"1":"3.666667","2":"high"},{"1":"3.000000","2":"high"},{"1":"2.000000","2":"low"},{"1":"2.750000","2":"low"},{"1":"2.250000","2":"low"},{"1":"1.750000","2":"low"},{"1":"3.000000","2":"high"},{"1":"4.750000","2":"high"},{"1":"4.000000","2":"high"},{"1":"4.000000","2":"high"},{"1":"2.500000","2":"low"},{"1":"3.750000","2":"high"},{"1":"1.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"3.750000","2":"high"},{"1":"2.750000","2":"low"},{"1":"2.750000","2":"low"},{"1":"4.250000","2":"high"},{"1":"2.250000","2":"low"},{"1":"5.000000","2":"high"},{"1":"3.750000","2":"high"},{"1":"4.500000","2":"high"},{"1":"4.500000","2":"high"},{"1":"1.500000","2":"low"},{"1":"4.250000","2":"high"},{"1":"3.250000","2":"high"},{"1":"4.000000","2":"high"},{"1":"5.000000","2":"high"},{"1":"3.250000","2":"high"},{"1":"4.000000","2":"high"},{"1":"4.250000","2":"high"},{"1":"4.250000","2":"high"},{"1":"1.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"1.000000","2":"low"},{"1":"3.250000","2":"high"},{"1":"3.500000","2":"high"},{"1":"2.500000","2":"low"},{"1":"4.000000","2":"high"},{"1":"3.750000","2":"high"},{"1":"2.000000","2":"low"},{"1":"2.000000","2":"low"},{"1":"2.000000","2":"low"},{"1":"1.750000","2":"low"},{"1":"2.750000","2":"low"},{"1":"2.000000","2":"low"},{"1":"3.000000","2":"high"},{"1":"1.250000","2":"low"},{"1":"4.000000","2":"high"},{"1":"2.250000","2":"low"},{"1":"2.500000","2":"low"},{"1":"1.250000","2":"low"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>That looks good to me, so let’s assign that output back to the dataset, removing the <code>.keep</code> argument before we do.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="ot">&lt;-</span> anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">stars_help_cat =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>      stars_help_score <span class="sc">&lt;</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"low"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>      stars_help_score <span class="sc">&gt;=</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> <span class="cn">NA</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Now, let’s get started on our barplot.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Follow along with the instructions to build your own plot as we go. Feel free to tweak details like colour and labels as you like.</p>
</div>
</div>
<p>To keep this to a 2x2 comparison, let’s compare our new STARS help category in male vs female participants. So, we’ll need to filter before beginning the plot.</p>
<p>Then, we’ll put our variable of interest - here, <code>stars_help_cat</code> - on the <em>x</em>-axis. Remember that in plots like this, the <em>y</em>-axis is the number of responses, and as we saw with histograms just above, R can do that for us automatically. So, we’ll skip the <em>y</em>-axis and instead add <code>gender</code> as a fill variable. Then, we’ll ask R to draw the right kind of geom for us - the transparently named <code>geom_bar()</code> - and throw on a nice theme on the end for good measure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"male"</span>,<span class="st">"female"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stars_help_cat, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hmm. This barplot is okay, but it’s not easy to compare the gender categories directly. The bars are filled with different colours based on the <code>gender</code> variable, which we wanted, but they’re stacked on top of each other!</p>
<section id="position-dodge" class="level3">
<h3 class="anchored" data-anchor-id="position-dodge">Position Dodge</h3>
<p>To “fix” this (assuming it isn’t what you want - it might be!), we can use the <code>position</code> argument in <code>geom_bar()</code> to move the bars side by side, instead of stacked on top of each other. This option is called “dodge”, so let’s see how it looks now:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"male"</span>,<span class="st">"female"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stars_help_cat, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Nice! Already that’s much better, and looking more like we might expect a grouped barplot to look. We do need to do <em>something</em> about those awful colours, but first let’s fix something that’s bothering me: the order of the <em>x</em>-axis categories.</p>
</section>
<section id="reordering-categories" class="level3">
<h3 class="anchored" data-anchor-id="reordering-categories">Reordering Categories</h3>
<p>The <code>stars_help_cat</code> variable on the <em>x</em>-axis has automatically ordered the categories in alphabetical order, “high” and then “low”. As I am a native speaker of a language that reads left to right, I’d prefer to have “low” on the left and “high” on the right<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. So, how can I change the order of these categories?</p>
<section id="option-1-scale-labels" class="level4">
<h4 class="anchored" data-anchor-id="option-1-scale-labels">Option 1: Scale Labels</h4>
<p>We’ve seen the <code>scale_*()</code> functions already - this time, we have a discrete <em>x</em>-axis variable, so we need <code>scale_x_discrete()</code>. We’ve even already seen the <code>limits =</code> argument used to set the upper and lower bound of the plot. Here, we can use this argument to specify the order we want the categories to be displayed in as well.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"male"</span>,<span class="st">"female"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stars_help_cat, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"low"</span>, <span class="st">"high"</span>)) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="option-2-factor-levels" class="level4">
<h4 class="anchored" data-anchor-id="option-2-factor-levels">Option 2: Factor Levels</h4>
<p>We haven’t covered factors much in this course so far; for our purposes, most of the time, R treats character data more or less the same way it would treat factors so it hasn’t been a problem (yet…). However, converting our <code>stars_help_cat</code> variable to a factor would let us specify an order of factor levels.</p>
<p>Let’s see how that would work. Here I’m using <code>mutate()</code> to do the factor conversion before I pipe the data on into <code>ggplot()</code>. We’ve seen the <code>factor()</code> function before, just adding the <code>levels =</code> argument to reorder the levels in the order we wanted. The resulting plot then has the levels in the right order.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"male"</span>,<span class="st">"female"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">stars_help_cat =</span> <span class="fu">factor</span>(stars_help_cat, </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"low"</span>, <span class="st">"high"</span>))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                ) <span class="sc">|&gt;</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stars_help_cat, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Which to prefer? If you are going to change your categorical variables into factors anyway, it might be a good idea to set any factor ordering at that point, so you don’t need to bother with this later. Otherwise, it doesn’t matter as long as your plot looks the way you want it at the end!</p>
<p>Right, now that all the structural stuff is out of the way, let’s finish up.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Finish up your plot by adjusting the following elements:</p>
<ul>
<li>Give a name to each axis</li>
<li>Relabel discrete categories where appropriate</li>
<li>Adjust continuous limits and breaks where appropriate</li>
<li>Choose new colours!</li>
</ul>
<p><em>Hint</em>: You’ll have three axes to adjust. Use the help documentation for each if you get stuck.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-39"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-39" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-39-1" class="code-annotation-target"><a href="#annotated-cell-39-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-39" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-39-2" class="code-annotation-target"><a href="#annotated-cell-39-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"male"</span>,<span class="st">"female"</span>)) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-39" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-39-3" class="code-annotation-target"><a href="#annotated-cell-39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stars_help_cat, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-39" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-39-4" class="code-annotation-target"><a href="#annotated-cell-39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-39" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-39-5" class="code-annotation-target"><a href="#annotated-cell-39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"STARS Asking for Help Anxiety"</span>,</span>
<span id="annotated-cell-39-6"><a href="#annotated-cell-39-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"low"</span>, <span class="st">"high"</span>),</span>
<span id="annotated-cell-39-7"><a href="#annotated-cell-39-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"High"</span>)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-39" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-39-8" class="code-annotation-target"><a href="#annotated-cell-39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Count"</span>,</span>
<span id="annotated-cell-39-9"><a href="#annotated-cell-39-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">175</span>),</span>
<span id="annotated-cell-39-10"><a href="#annotated-cell-39-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">175</span>, <span class="at">by =</span> <span class="dv">25</span>))<span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-39" data-target-annotation="7" onclick="event.preventDefault();">7</a><span id="annotated-cell-39-11" class="code-annotation-target"><a href="#annotated-cell-39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">"Gender"</span>,</span>
<span id="annotated-cell-39-12"><a href="#annotated-cell-39-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>),</span>
<span id="annotated-cell-39-13"><a href="#annotated-cell-39-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"#1b365d"</span>, <span class="st">"#f2c75c"</span>)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-39" data-target-annotation="8" onclick="event.preventDefault();">8</a><span id="annotated-cell-39-14" class="code-annotation-target"><a href="#annotated-cell-39-14" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-39" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-39" data-code-lines="1" data-code-annotation="1">Take the dataset, <em>and then</em></span>
</dd>
<dt data-target-cell="annotated-cell-39" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-39" data-code-lines="2" data-code-annotation="2">Filter the dataset to only retain cases where the value in the <code>gender</code> variable is any of “male” or “female”, <em>and then</em></span>
</dd>
<dt data-target-cell="annotated-cell-39" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-39" data-code-lines="3" data-code-annotation="3">Set up a plot, mapping <code>stars_help_score</code> to the <em>x</em>-axis and <code>gender</code> as the fill, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-39" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-39" data-code-lines="4" data-code-annotation="4">Draw a barplot, with the bars side by side, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-39" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-39" data-code-lines="5,6,7" data-code-annotation="5">Adjust the discrete <em>x</em> axis by giving it a name, setting the limits (i.e.&nbsp;order of categories), and relabeling the categories, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-39" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-39" data-code-lines="8,9,10" data-code-annotation="6">Adjust the continuous <em>y</em> axis by giving it a name, setting the limits, and setting the breakpoints to appear as ticks on the axis, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-39" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-39" data-code-lines="11,12,13" data-code-annotation="7">Adjust the discrete fill legend by giving it a name, relabeling the categories, and changing the type of colours (using a colourblind-friendly and greyscale-print-resilient colour scheme!), <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-39" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-39" data-code-lines="14" data-code-annotation="8">Add an APA-style theme.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="Check Order of Labels!">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Order of Labels!
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Keep in mind that <code>ggplot()</code> is just applying the labels as strings on top of your plot. This means that if you, for instance, reorder your categories on the <em>x</em>-axis but then forget to update the order of axis labels in your code, your plot will be wrong. It’s always important to double-check that the labels you add do in fact correspond correctly to the order of the categories in the plot to avoid mislabeling.</p>
<p>As an example, the code below is identical to the solution above, except I’ve commented out the <code>limits</code> argument in <code>scale_x_discrete()</code> that reorders the categories on the <em>x</em>-axis. However, I’ve left in the <code>labels</code> argument that whacks on the axis labels in the reordered order. Comparing to the plot above, we can see by the sizes of the bars that the actual categories are in high-low order, despite what the nicely formatted labels say.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"male"</span>,<span class="st">"female"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stars_help_cat, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"STARS Asking for Help Anxiety"</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                   <span class="do">## limits = c("low", "high"),</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"High"</span>)) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Count"</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">175</span>),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">175</span>, <span class="at">by =</span> <span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">"Gender"</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>),</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"#1b365d"</span>, <span class="st">"#f2c75c"</span>)) <span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>One method to avoid this is to add formatting outside of <code>ggplot()</code>. In essence, instead of pasting on the labels afterwards, you edit the data just before piping into <code>ggplot()</code> so that the labels are already correctly formatted and in the right order. For this current situation with one plot, it’s much of a muchness whether the relabeling is in the data (via <code>mutate</code>) or in the axis labels. However, if you wanted to create <em>multiple</em> plots with these variables, relabeling the data just before plot creation would likely be more efficient than pasting in/checking the labels for each plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"male"</span>,<span class="st">"female"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## This backticked name is kind of an extreme step! But it's possible</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">STARS Asking for Help Anxiety</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(stars_help_cat, </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"low"</span>, <span class="st">"high"</span>),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"High"</span>)),</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">Gender =</span> <span class="fu">factor</span> (gender,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>),</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Note the formatted names here, and the backticks for the illegal variable name</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">STARS Asking for Help Anxiety</span><span class="st">`</span>, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Count"</span>,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">175</span>),</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">175</span>, <span class="at">by =</span> <span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">type =</span> <span class="fu">c</span>(<span class="st">"#1b365d"</span>, <span class="st">"#f2c75c"</span>)) <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
</section>
</section>
<section id="quick-test-chi2" class="level2">
<h2 class="anchored" data-anchor-id="quick-test-chi2">Quick Test: <span class="math inline">\(\chi^2\)</span></h2>
<p>While we’re here looking at grouped barplots for categorical data, we can also have a quick <span class="math inline">\(\chi^2\)</span> test of association as a treat. Just like we did <em>t</em>-tests with <code>t.test()</code> and correlation tests with <code>cor.test()</code>, for <span class="math inline">\(\chi^2\)</span> we have <code>chisq.test()</code>.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using the <code>chisq.test()</code> help documentation, perform a <span class="math inline">\(\chi^2\)</span> test of association for the <code>stars_help_cat</code> and <code>gender</code> variables.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>First, you can bring up the help documentation by running <code>?chisq.test</code> in the Console.</p>
<p>You might notice right away that this function has no <code>data =</code> argument, and neither does it have an option to specify a formula like we’ve used previously. Instead, we just need to provide two vectors (or a matrix; see the Challenge task).</p>
<p>Recall that when we made our plots above, we filtered the <code>gender</code> variable to contain only male and female participants. Here we need to do the same thing before we can run our test. To make sure I don’t drop these cases from my actual dataset, I’m going to create a new, filtered version of the dataset <em>only</em> for running this test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data_chisq <span class="ot">&lt;-</span> anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"male"</span>,<span class="st">"female"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we need to get each of the variables out of the dataset using <code>$</code> subsetting. This is <em>exactly</em> the same method we used in the very first tutorial to run a <em>t</em>-test! Remember to use the new, filtered dataset rather than the original.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(anx_scores_data_chisq<span class="sc">$</span>gender, anx_scores_data_chisq<span class="sc">$</span>stars_help_cat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  anx_scores_data_chisq$gender and anx_scores_data_chisq$stars_help_cat
X-squared = 3.1266, df = 1, p-value = 0.07702</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>CHALLENGE</strong>: Use a matrix to run this test, instead of two individual vectors.</p>
<p><em>Hint</em>: The way I’ve solved it, this requires reading the help documentation carefully and using a new function to create a <code>table()</code>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The vector method we just saw took just the data, so we might first try doing that with a smaller version of the dataset (doing the filtering on <code>gender</code>, then selecting only the two variables we want):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(gender, stars_help_cat) <span class="sc">|&gt;</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chisq.test</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in sum(x): invalid 'type' (character) of argument</code></pre>
</div>
</div>
<p>No dice, and a weird error. Hmm. What does the help documentation have to say?</p>
<p>Under <strong>Details</strong>, we read:</p>
<blockquote class="blockquote">
<p>If x is a matrix with at least two rows and columns, it is taken as a two-dimensional contingency table: the entries of x must be non-negative integers.</p>
</blockquote>
<p>Aha. Okay. So, we can’t just use the actual variables; we have to give <code>chisq.test()</code> a contingency table of the counts within each combination of categories. The hint points us to the <code>table()</code> function, which we haven’t covered before because it doesn’t produce nicely formattable output. What it DOES do, however, is produce exactly the contingency table we want, which we can then pipe on to <code>chisq.test()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(gender, stars_help_cat) <span class="sc">|&gt;</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>() <span class="sc">|&gt;</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chisq.test</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  table(dplyr::select(dplyr::filter(anx_scores_data, gender %in%     c("female", "male")), gender, stars_help_cat))
X-squared = 3.1266, df = 1, p-value = 0.07702</code></pre>
</div>
</div>
<p>This code has a few extra steps, but allows us to avoid creating a specialised sub-copy of our dataset! Personally I’d prefer this version, but we teach UG students the vector version as it’s slightly more straightforward.</p>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>CHALLENGE</strong>: Report the results of the <span class="math inline">\(\chi^2\)</span> test in full, including a check of whether the expected frequencies are all greater than 5.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s get the latter out of the way first. Under <strong>Examples</strong>, the help documentation shows us right at the top how to get expected frequencies: if we save our test output in an object, we can subset it. Let’s have a look:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>anx_gender_chisq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(anx_scores_data_chisq<span class="sc">$</span>gender, anx_scores_data_chisq<span class="sc">$</span>stars_help_cat)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>anx_gender_chisq<span class="sc">$</span>expected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            
anx_scores_data_chisq$gender      high       low
                      female 156.78534 165.21466
                      male    29.21466  30.78534</code></pre>
</div>
</div>
<p>If we don’t want to rely on visual checks (usually wise), we can ask R to check if there’s an issue with expected frequencies:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(anx_gender_chisq<span class="sc">$</span>expected <span class="sc">&gt;</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Great, we can then go on to report the results! Let’s save the <code>papaja::apa_print()</code> output in an object, which we can then use in our inline code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>chisq_out <span class="ot">&lt;-</span> papaja<span class="sc">::</span><span class="fu">apa_print</span>(anx_gender_chisq, <span class="at">n =</span> <span class="fu">nrow</span>(anx_scores_data_chisq))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>A <span class="math inline">\(\chi^2\)</span> test of association revealed no significant association relationship between gender and STARS Asking for Help anxiety (<code>`r chisq_out$full_result[[1]]`</code>).</p>
</blockquote>
<p>Which will appear when rendered as:</p>
<blockquote class="blockquote">
<p>A <span class="math inline">\(\chi^2\)</span> test of association revealed no significant association relationship between gender and STARS Asking for Help anxiety (<span class="math inline">\(\chi^2(1, n = 382) = 3.13\)</span>, <span class="math inline">\(p = .077\)</span>).</p>
</blockquote>
</div>
</div>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="raincloud-and-violin-plots" class="level2">
<h2 class="anchored" data-anchor-id="raincloud-and-violin-plots">Raincloud and Violin Plots</h2>
<p>For this section, we’ll focus on making nice raincloud plots, which we teach repeatedly in UG Year 1. For both of these plots, we’re going to expand our {ggplot} vocab by explicitly including a <em>y</em>-axis variable.</p>
<p>Raincloud plots are introduced in the second half of first year for Sussex UGs. I love them especially because they pack in so much useful information in a reasonably easy-to-read plot. We teach UGs to read them and practice them several times, including in an assessment. Despite their complexity, they are extremely easy to create thanks to the recently-released {ggrain} package that does most of the heavy lifting for you.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Follow along with the instructions below to build your own plot as we go. Feel free to tweak details like colour and labels as you like.</p>
</div>
</div>
<p>Let’s start by creating a basic raincloud plot of STARS Test subscale score split up by MCQ group. As we already covered above, I’m going to clean up the plot a bit with some scale formatting and a theme.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-16"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-16-1" class="code-annotation-target"><a href="#annotated-cell-16-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-16-2" class="code-annotation-target"><a href="#annotated-cell-16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mcq, <span class="at">y =</span> stars_test_score)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-16-3" class="code-annotation-target"><a href="#annotated-cell-16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rain</span>() <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-16-4" class="code-annotation-target"><a href="#annotated-cell-16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"MCQ Condition"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Maths"</span>, <span class="st">"Stats"</span>)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-16-5" class="code-annotation-target"><a href="#annotated-cell-16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Mean STARS Test Score"</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-16-6" class="code-annotation-target"><a href="#annotated-cell-16-6" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-16" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="1" data-code-annotation="1">Take the dataset <code>anx_scores_data</code>, <em>and then</em></span>
</dd>
<dt data-target-cell="annotated-cell-16" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="2" data-code-annotation="2">Set up a plot, mapping <code>mcq</code> to the <em>x</em>-axis and <code>stars_test_score</code> to the <em>y</em>-axis, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-16" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="3" data-code-annotation="3">Draw a raincloud plot, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-16" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="4" data-code-annotation="4">Adjust the discrete <em>x</em> axis by giving it a name, and relabelling the group labels, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-16" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="5" data-code-annotation="5">Adjust the continuous <em>y</em> axis by giving it a name, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-16" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="6" data-code-annotation="6">Add an APA-style theme.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The default plot has three parts. From left to right, they are: a scatter of the data points; a boxplot; and a density plot of the data, turned on its side. If you tilt your head to the right, you can see that this looks a bit like a (very lumpy) cloud with the data falling like rain underneath.</p>
<p>We already have a good amount of information here, but one thing we are missing is the means in each group. We introduce raincloud plots in the context of <em>t</em>-tests, where the difference in group means is the key element of interest, so let’s add them to our plot, along with some colour adjustments.</p>
<section id="calculating-stats" class="level3">
<h3 class="anchored" data-anchor-id="calculating-stats">Calculating Stats</h3>
<p>To add means and CIs to our plot, we’ll need to calculate them. However, there’s no need to create a summary first - we can use a <code>stat_*()</code> function to calculate the necessary statistics inside our plot.</p>
<p>In this case, we can use <code>stat_summary()</code> to produce some summary statistics. To really make it quick, we’re going to quote the function <code>mean_cl_boot</code>, which calculates means and bootstrapped CIs. That’s it - just that one line does all the maths and adds the result to the plot. However, the new element will show up as black by default, so let’s also add in a colour to make sure we can actually see it. (I’ve chosen something obnoxious to make it easy to find!)</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-17"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-17-1" class="code-annotation-target"><a href="#annotated-cell-17-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-17-2" class="code-annotation-target"><a href="#annotated-cell-17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mcq, <span class="at">y =</span> stars_test_score)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-17-3" class="code-annotation-target"><a href="#annotated-cell-17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rain</span>() <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-17-4" class="code-annotation-target"><a href="#annotated-cell-17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"MCQ Condition"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Maths"</span>, <span class="st">"Stats"</span>)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-17-5" class="code-annotation-target"><a href="#annotated-cell-17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Mean STARS Test Score"</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-17-6" class="code-annotation-target"><a href="#annotated-cell-17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="7" onclick="event.preventDefault();">7</a><span id="annotated-cell-17-7" class="code-annotation-target"><a href="#annotated-cell-17-7" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-17" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="1" data-code-annotation="1">Take the dataset <code>anx_scores_data</code>, <em>and then</em></span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="2" data-code-annotation="2">Set up a plot, mapping <code>mcq</code> to the <em>x</em>-axis and <code>stars_test_score</code> to the <em>y</em>-axis, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="3" data-code-annotation="3">Draw a raincloud plot, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="4" data-code-annotation="4">Adjust the discrete <em>x</em> axis by giving it a name, and relabelling the group labels, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="5" data-code-annotation="5">Adjust the continuous <em>y</em> axis by giving it a name, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="6" data-code-annotation="6">Calculate a summary of the data using the function <code>mean_cl_normal</code> for means and CIs, and add to the plot in red, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="7" data-code-annotation="7">Add an APA-style theme.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>In second year, students are also introduced to violin plots. Adapt the code we’ve already written for raincloud plots to create a violin plot with means and CIs instead.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is literally only a case of changing <code>geom_rain()</code> to <code>geom_violin()</code> - everything else works as is. This helps illustrate the use of the <code>geom_*()</code> functions for determining the <em>kind</em> of plot you have.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mcq, <span class="at">y =</span> stars_test_score)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> <span class="co"># Only this line is different!</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"MCQ Condition"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Maths"</span>, <span class="st">"Stats"</span>)) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Mean STARS Test Score"</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>CHALLENGE</strong>: The raincloud plot we produced above was serviceable but not very <em>aesthetic</em>. See if you can adapt that code to reproduce the plot below.</p>
<p><em>Hints</em>: Run <code>vignette("ggrain")</code> in the Console for a friendly tour of the options for raincloud plots. The colours are all from the Sussex colour palette.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This would have involved quite a bit of experimentation. If you made something like this, well done.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-55"><pre class="sourceCode r code-annotation-code code-with-copy"><code class="sourceCode r"><span id="annotated-cell-55-1"><a href="#annotated-cell-55-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span></span>
<span id="annotated-cell-55-2"><a href="#annotated-cell-55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mcq, <span class="at">y =</span> stars_test_score, <span class="at">fill =</span> mcq)) <span class="sc">+</span></span>
<span id="annotated-cell-55-3"><a href="#annotated-cell-55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rain</span>(<span class="at">point.args =</span> <span class="fu">list</span>(<span class="at">alpha =</span> .<span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">colour =</span> mcq))) <span class="sc">+</span></span>
<span id="annotated-cell-55-4"><a href="#annotated-cell-55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal,</span>
<span id="annotated-cell-55-5"><a href="#annotated-cell-55-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">23</span>) <span class="sc">+</span></span>
<span id="annotated-cell-55-6"><a href="#annotated-cell-55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"MCQ Condition"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Maths"</span>, <span class="st">"Stats"</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-55-7"><a href="#annotated-cell-55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Mean STARS Test Score"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-55-8"><a href="#annotated-cell-55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#f2c75c"</span>, <span class="st">"#007a78"</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-55-9"><a href="#annotated-cell-55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#dc582a"</span>, <span class="st">"#003b49"</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-55-10"><a href="#annotated-cell-55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">'none'</span>, <span class="at">color =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="annotated-cell-55-11"><a href="#annotated-cell-55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="annotated-cell-55-12"><a href="#annotated-cell-55-12" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- 1.  Take the dataset `anx_scores_data`, *and then* -->
<!-- 2.  Set up a plot, mapping `mcq` to the *x*-axis, `stars_test_score` to the *y*-axis, and fill colour to `mcq`, *plus* -->
<!-- 3.  Draw a raincloud plot, setting the transparency of the points to 40% and the colour to differ based on `mcq`, *plus* -->
<!-- 4.  Calculate a summary of the data using the function `mean_cl_normal` for means and CIs, and add to the plot using a diamond shape, *plus* -->
<!-- 5.  Adjust the discrete *x* axis by giving it a name, and relabelling the group labels, *plus*  -->
<!-- 6.  Adjust the continuous *y* axis by giving it a name, *plus* -->
<!-- 7.  Adjust the fill to custom values, *plus* -->
<!-- 8.  Adjust the colour to custom values, *plus* -->
<!-- 9.  Remove the fill and colour legends, *plus* -->
<!-- 10. Flip the coordinates to reverse *x* and *y*, *plus* -->
<!-- 11.  Add an APA-style theme. -->
</div>
</div>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
</section>
<section id="scatterplots" class="level2">
<h2 class="anchored" data-anchor-id="scatterplots">Scatterplots</h2>
<p>Let’s now turn to continuous variables only and produce a scatterplot to visualise a linear relationship.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Follow along with the instructions below to build your own plot as we go. Feel free to tweak details like colour and labels as you like.</p>
</div>
</div>
<p>To start, let’s set up a basic plot using the STICSA pre- and post-MCQ state anxiety scores. The new element is <code>geom_point()</code>, which draws points <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. In that layer, we also have two new arguments. The first is <code>alpha</code>, which sets the transparency of the points between 1 (solid) and 0 (invisible). The second is <code>position = "jitter"</code>, which introduces some random noise into the placement of the points so make it easier to see overlapping values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-18"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-18" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-18-1" class="code-annotation-target"><a href="#annotated-cell-18-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-18" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-18-2" class="code-annotation-target"><a href="#annotated-cell-18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sticsa_pre_state_score, <span class="at">y =</span> sticsa_post_state_score)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-18" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-18-3" class="code-annotation-target"><a href="#annotated-cell-18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="st">"jitter"</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-18" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-18-4" class="code-annotation-target"><a href="#annotated-cell-18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"STICSA Pre-MCQ State Anxiety Score"</span>,</span>
<span id="annotated-cell-18-5"><a href="#annotated-cell-18-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-18" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-18-6" class="code-annotation-target"><a href="#annotated-cell-18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"STICSA Post-MCQ State Anxiety Score"</span>,</span>
<span id="annotated-cell-18-7"><a href="#annotated-cell-18-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-18" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-18-8" class="code-annotation-target"><a href="#annotated-cell-18-8" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-18" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-18" data-code-lines="1" data-code-annotation="1">Take the dataset <code>anx_scores_data</code>, <em>and then</em></span>
</dd>
<dt data-target-cell="annotated-cell-18" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-18" data-code-lines="2" data-code-annotation="2">Set up a plot, mapping <code>sticsa_pre_state_score</code> to the <em>x</em>-axis and <code>sticsa_post_state_score</code> to the <em>y</em>-axis, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-18" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-18" data-code-lines="3" data-code-annotation="3">Draw points, with 40% transparency and some random noise to separate them, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-18" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-18" data-code-lines="4,5" data-code-annotation="4">Adjust the continuous <em>x</em> axis by giving it a name, and setting the limits to 1 and 4, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-18" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-18" data-code-lines="6,7" data-code-annotation="5">Adjust the continuous <em>x</em> axis by giving it a name, and setting the limits to 1 and 4, <em>plus</em></span>
</dd>
<dt data-target-cell="annotated-cell-18" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-18" data-code-lines="8" data-code-annotation="6">Add an APA-style theme.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Not bad, eh? Right off the bat we get a very passable scatterplot. Now, assuming that this scatterplot might accompany a linear model, we might also like to draw that model on our plot.</p>
<section id="line-of-best-fit" class="level3">
<h3 class="anchored" data-anchor-id="line-of-best-fit">Line of Best Fit</h3>
<p>Unfortunately the function to add a line of best fit isn’t as intuitively named as you might expect. Both <code>geom_smooth()</code> and <code>stat_smooth()</code> will do what we want here; in first year, we teach UGs <code>geom_smooth()</code> for this, so we’ll use that here too. (There is a <code>geom_line()</code> but isn’t quite the same!)</p>
<p>As we did with the histogram previously, we can add <code>colour</code> and <code>fill</code> arguments to adjust the colour. Here, <code>colour</code> determines the colour of the line, and <code>fill</code> determines the colour of the shaded confidence intervals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-19"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-19-1"><a href="#annotated-cell-19-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span></span>
<span id="annotated-cell-19-2"><a href="#annotated-cell-19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sticsa_pre_state_score, <span class="at">y =</span> sticsa_post_state_score)) <span class="sc">+</span></span>
<span id="annotated-cell-19-3"><a href="#annotated-cell-19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="st">"jitter"</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-19" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-19-4" class="code-annotation-target"><a href="#annotated-cell-19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="annotated-cell-19-5"><a href="#annotated-cell-19-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">"darkblue"</span>,</span>
<span id="annotated-cell-19-6"><a href="#annotated-cell-19-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"darkcyan"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-19-7"><a href="#annotated-cell-19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"STICSA Pre-MCQ State Anxiety Score"</span>,</span>
<span id="annotated-cell-19-8"><a href="#annotated-cell-19-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-19-9"><a href="#annotated-cell-19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"STICSA Post-MCQ State Anxiety Score"</span>,</span>
<span id="annotated-cell-19-10"><a href="#annotated-cell-19-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-19-11"><a href="#annotated-cell-19-11" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-19" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-19" data-code-lines="4,5,6" data-code-annotation="1">Add a line of best fit using the “<code>lm</code>” function, with a dark blue line and dark cyan CIs.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="colour-and-fill-palette" class="level3">
<h3 class="anchored" data-anchor-id="colour-and-fill-palette">Colour and Fill Palette</h3>
<p>In the <a href="../../tutorials/archive_autumn_2023/07_dataviz.html#colour-and-fill-manual">previous Colour and Fill section</a> we chose colours by name or hex code to add to a plot. However, there are a wide variety of pre-made colour palettes to make use of. So, instead of choosing individual colours, you can quickly apply existing colour palettes.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Colour Palette Options">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Colour Palette Options
</div>
</div>
<div class="callout-body-container callout-body">
<p>Looking for the right colour scheme? Try these resources:</p>
<ul>
<li><a href="https://www.datanovia.com/en/blog/top-r-color-palettes-to-know-for-great-data-visualization/#scientific-journal-color-palettes">This blog post on R colour palettes</a> is a great overview of some of the most popular options available, with lots of examples.</li>
<li><a href="https://emilhvitfeldt.github.io/paletteer/">The {paletteer} package</a> for quick access to any R colour palette and to an overview of all the palettes available</li>
</ul>
</div>
</div>
<p>A popular palette and the one we’ll use for this task is from <a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html">the lovely {viridis} colour palette package</a>, designed to be pretty, print-friendly, and accessible (robust to colourblindness).</p>
<p>To use the palettes, we start out by dropping the <code>colour</code> and <code>fill</code> arguments from within <code>geom_smooth()</code>, and instead setting <code>colour</code> and <code>fill</code> arguments at the beginning of the plot, in the <code>aes()</code> function along with <code>x</code> and <code>y</code>. This will apply the same colour palette across all elements in the plot that can have colour - namely, the points from <code>geom_point()</code>, and the line of best fit from <code>geom_smooth()</code>. By setting them both to <code>mcq</code>, the colours will be consistent across MCQ types between all of these elements. Incidentally, doing this will also split our single LM line into two lines: one for each level of the <code>mcq</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-20"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-20-1"><a href="#annotated-cell-20-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-20" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-20-2" class="code-annotation-target"><a href="#annotated-cell-20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sticsa_trait_score, <span class="at">y =</span> sticsa_post_state_score,</span>
<span id="annotated-cell-20-3"><a href="#annotated-cell-20-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> mcq, <span class="at">fill =</span> mcq)) <span class="sc">+</span></span>
<span id="annotated-cell-20-4"><a href="#annotated-cell-20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="st">"jitter"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-20-5"><a href="#annotated-cell-20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-20-6"><a href="#annotated-cell-20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"STICSA Pre-MCQ State Anxiety Score"</span>,</span>
<span id="annotated-cell-20-7"><a href="#annotated-cell-20-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-20-8"><a href="#annotated-cell-20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"STICSA Post-MCQ State Anxiety Score"</span>,</span>
<span id="annotated-cell-20-9"><a href="#annotated-cell-20-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-20-10"><a href="#annotated-cell-20-10" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-20" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-20" data-code-lines="2,3" data-code-annotation="1">Set up the plot, mapping <code>sticsa_pre_state_score</code> to the <em>x</em>-axis and <code>sticsa_post_state_score</code> to the <em>y</em>-axis, and both colour and fill to <code>mcq</code>.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A start - but let’s do something about that horrible default colour palette!</p>
<p>Just as we had <code>scale_x...</code> and <code>scale_y...</code> functions for specifying the <code>x</code> and <code>y</code> scales, we have <code>scale_colour...</code> and <code>scale_fill...</code> for specifying the details about the way the colour and fill appears. Here, I’m using viridis, which has its own dedicated functions, <code>scale_colour_viridis()</code> and <code>scale_fill_viridis()</code><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. Within those two new elements, we have the same two elements:</p>
<ul>
<li><code>name</code>: gives a title for the colour/fill legend</li>
<li><code>discrete</code>: tells {viridis} whether the variable to be coloured/filled is discrete or not. Here it is (it’s <code>mcq</code>, a categorical variable), so we set this to <code>TRUE</code>.</li>
<li><code>labels</code>: applies labels to the levels of the variables.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-21"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-21-1"><a href="#annotated-cell-21-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-21-2"><a href="#annotated-cell-21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sticsa_trait_score, <span class="at">y =</span> sticsa_post_state_score,</span>
<span id="annotated-cell-21-3"><a href="#annotated-cell-21-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> mcq, <span class="at">fill =</span> mcq)) <span class="sc">+</span></span>
<span id="annotated-cell-21-4"><a href="#annotated-cell-21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="st">"jitter"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-21-5"><a href="#annotated-cell-21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-21-6"><a href="#annotated-cell-21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"STICSA Pre-MCQ State Anxiety Score"</span>,</span>
<span id="annotated-cell-21-7"><a href="#annotated-cell-21-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-21-8"><a href="#annotated-cell-21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"STICSA Post-MCQ State Anxiety Score"</span>,</span>
<span id="annotated-cell-21-9"><a href="#annotated-cell-21-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-21" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-21-10" class="code-annotation-target"><a href="#annotated-cell-21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis</span>(<span class="at">name =</span> <span class="st">"MCQ Type"</span>,</span>
<span id="annotated-cell-21-11"><a href="#annotated-cell-21-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">discrete =</span> <span class="cn">TRUE</span>,</span>
<span id="annotated-cell-21-12"><a href="#annotated-cell-21-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Maths"</span>, <span class="st">"Stats"</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-21-13"><a href="#annotated-cell-21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">name =</span> <span class="st">"MCQ Type"</span>,</span>
<span id="annotated-cell-21-14"><a href="#annotated-cell-21-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">discrete =</span> <span class="cn">TRUE</span>,</span>
<span id="annotated-cell-21-15"><a href="#annotated-cell-21-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Maths"</span>, <span class="st">"Stats"</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-21-16"><a href="#annotated-cell-21-16" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-21" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-21" data-code-lines="10,11,12,13,14,15" data-code-annotation="1">Adjust the fill and colour by applying the viridis colour palette, giving each a name, using discrete values, and relabelling the categories.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That’s looking fairly nice now!</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>CHALLENGE</strong>: In the code above, I had to repeat a lot of elements for both <code>fill</code> and <code>colour</code>. See if you can figure out how to remove the need to change the name and labels within the plotting code by making a change to the dataset beforehand.</p>
<p><em>Hint</em>: You might try a non-standard variable name with backticks!</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In order to remove some of the near-identical code above, I can first make a change to my dataset before I start the plot. Here, I’m using <code>mutate()</code> to create a new variable, <code>MCQ Type</code>. This variable contains exactly the same information as <code>mcq</code>, except that the values have a capitalised first letter. Essentially, I’m removing the need to reformat later by formatting the data before it’s plotted.</p>
<p>The only thing I then have to do is swap out <code>mcq</code> for <code>MCQ Type</code> as my colour and fill variables. Notice that the backticks are <strong>essential</strong> here, in both <code>mutate()</code> and <code>aes()</code>, otherwise the space in the variable name will throw an error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="sc">|&gt;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">MCQ Type</span><span class="st">`</span> <span class="ot">=</span> stringr<span class="sc">::</span><span class="fu">str_to_title</span>(mcq)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sticsa_trait_score, <span class="at">y =</span> sticsa_post_state_score,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">`</span><span class="at">MCQ Type</span><span class="st">`</span>, <span class="at">fill =</span> <span class="st">`</span><span class="at">MCQ Type</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="st">"jitter"</span>) <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"STICSA Pre-MCQ State Anxiety Score"</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"STICSA Post-MCQ State Anxiety Score"</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="d-plots" class="level3">
<h3 class="anchored" data-anchor-id="d-plots">3D Plots</h3>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Note</em>: 3D plots really should be used with caution, and this bit is just for fun - feel free to skip if you’re not inclined. If you’re keen to have a go, the code below gets you an interactive, useable 3D scatterplot in no time at all, but think carefully about whether this is really the best way to represent your data.</p>
</div>
</div>
<p>In something of a departure for us, we’re going to use a package <em>that isn’t {ggplot2}</em> for this next bit. (Shock! Horror!) Instead, we’ll use the <code>plot3d()</code> function from the {rgl} package to get a snazzy interactive 3D-plot that does rotation and zoom right out of the box. The syntax might look slightly unfamiliar, but it’s got the same underlying idea as what we’ve seen so far.</p>
<p>In order to have points coloured by MCQ type, I’ve created a new variable in the dataset assigning colours based on the values of the <code>mcq</code> variable. This and the rest of the code is borrowed straight from <a href="https://r-graph-gallery.com/3d_scatter_plot.html">R Graph Gallery’s very helpful mini-tutorial on {rgl}</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column with color</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>anx_scores_data <span class="ot">&lt;-</span> anx_scores_data <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_colours =</span> <span class="fu">ifelse</span>(mcq <span class="sc">==</span> <span class="st">"maths"</span>, <span class="st">"orange"</span>, <span class="st">"darkcyan"</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we’ll use the <code>rgl::plot3d()</code> function to generate the plot. The <code>x</code>, <code>y</code>, and <code>z</code> arguments each are specified using <code>$</code> subsetting, and the colours in <code>col</code> come from the new variable I created just above. The rest of the arguments change the appearance of the points (<code>type</code> and <code>size</code>) and set the axis labels.</p>
<div class="cell" data-webgl="true">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>rgl<span class="sc">::</span><span class="fu">plot3d</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> anx_scores_data<span class="sc">$</span>sticsa_trait_score, </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> anx_scores_data<span class="sc">$</span>sticsa_post_state_score,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> anx_scores_data<span class="sc">$</span>sticsa_pre_state_score,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> anx_scores_data<span class="sc">$</span>plot_colours,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"s"</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">radius =</span> .<span class="dv">05</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"STICSA Trait"</span>, <span class="at">ylab =</span> <span class="st">"STICSA Post State"</span>, <span class="at">zlab =</span> <span class="st">"STICSA Pre State"</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div id="rgl4873" style="width:100%;height:464px;" class="rglWebGL html-widget " aria-labelledby="rgl4873-aria"></div>
<script type="application/json" data-for="rgl4873">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmode":"modulate","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":7,"objects":{"13":{"id":13,"type":"spheres","material":{},"vertices":"0","colors":"1","radii":[[0.05000000074505806]],"centers":"2","ignoreExtent":false,"fastTransparency":true,"flags":32771},"15":{"id":15,"type":"text","material":{"lit":false,"margin":0,"floating":true,"edge":[0,1,1]},"vertices":"3","colors":"4","texts":[["STICSA Trait"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"5","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"16":{"id":16,"type":"text","material":{"lit":false,"margin":1,"floating":true,"edge":[1,1,1]},"vertices":"6","colors":"7","texts":[["STICSA Post State"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"8","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"17":{"id":17,"type":"text","material":{"lit":false,"margin":2,"floating":true,"edge":[1,1,1]},"vertices":"9","colors":"10","texts":[["STICSA Pre State"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"11","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"11":{"id":11,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"10":{"id":10,"type":"background","material":{},"colors":"12","centers":"13","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"12":{"id":12,"type":"background","material":{"lit":false,"back":"lines"},"colors":"14","centers":"15","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"14":{"id":14,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":"16","colors":"17","axes":{"mode":["pretty","pretty","pretty"],"step":[0.5,0.5,0.5],"nticks":[5,5,5],"marklen":[15,15,15],"expand":[1.029999971389771,1.029999971389771,1.029999971389771]},"draw_front":true,"flags":32769},"7":{"id":7,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":7,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,12.26927185058594],"modelMatrix":[[0.9621521830558777,0,0,-2.359563589096069],[0,0.3460965752601624,0.9675748944282532,-3.104751825332642],[0,-0.9508925080299377,0.352168470621109,-10.83535385131836],[0,0,0,1]],"projMatrix":[[3.732050895690918,0,0,0],[0,3.732050895690918,0,0],[0,0,-3.863703012466431,-44.22930908203125],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201433256682,0.9396926207859085,0],[0,-0.9396926207859085,0.3420201433256682,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.9621521830558777,1.011918663978577,1.029671669006348],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0.9480331540107727,3.95672869682312,0.9505889415740967,3.811315774917603,0.9514408111572266,3.762844800949097],"windowRect":[0,0,256,256],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NA","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[12,14,13,15,16,17,11],"subscenes":[],"flags":34067}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":672,"height":480,"buffer":{"accessors":[{"bufferView":0,"componentType":5126,"count":465,"type":"VEC3"},{"bufferView":1,"componentType":5121,"count":465,"type":"VEC4","normalized":true},{"bufferView":2,"componentType":5126,"count":465,"type":"VEC3"},{"bufferView":3,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":4,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":6,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":7,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":9,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":10,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":11,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":12,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":13,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":14,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":15,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":16,"componentType":5126,"count":18,"type":"VEC3"},{"bufferView":17,"componentType":5121,"count":1,"type":"VEC4"}],"bufferViews":[{"buffer":0,"byteLength":5580,"byteOffset":0},{"buffer":0,"byteLength":1860,"byteOffset":5580},{"buffer":0,"byteLength":5580,"byteOffset":7440},{"buffer":0,"byteLength":12,"byteOffset":13020},{"buffer":0,"byteLength":4,"byteOffset":13032},{"buffer":0,"byteLength":12,"byteOffset":13036},{"buffer":0,"byteLength":12,"byteOffset":13048},{"buffer":0,"byteLength":4,"byteOffset":13060},{"buffer":0,"byteLength":12,"byteOffset":13064},{"buffer":0,"byteLength":12,"byteOffset":13076},{"buffer":0,"byteLength":4,"byteOffset":13088},{"buffer":0,"byteLength":12,"byteOffset":13092},{"buffer":0,"byteLength":16,"byteOffset":13104},{"buffer":0,"byteLength":3,"byteOffset":13120},{"buffer":0,"byteLength":4,"byteOffset":13123},{"buffer":0,"byteLength":3,"byteOffset":13127},{"buffer":0,"byteLength":216,"byteOffset":13132},{"buffer":0,"byteLength":4,"byteOffset":13348}],"buffers":[{"byteLength":13352,"bytes":"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\nMQwDQGIYBkB6nuc/z/O8P7dt2z9VVdU/27YtQCVJUkD0PA9A9DwPQG7btj89z/M/kiQJQPQ8\nzz8xDANAt23bPwAAwH+rqqo//6UA/wCLi/8Ai4v//6UA//+lAP8Ai4v//6UA/wCLi///pQD/\nAIuL//+lAP//pQD/AIuL/wCLi/8Ai4v//6UA/wCLi///pQD//6UA/wCLi///pQD/AIuL//+l\nAP8Ai4v/AIuL//+lAP//pQD//6UA/wCLi/8Ai4v//6UA//+lAP8Ai4v/AIuL//+lAP//pQD/\nAIuL/wCLi///pQD//6UA/wCLi///pQD/AIuL/wCLi///pQD//6UA/wCLi///pQD/AIuL/wCL\ni///pQD/AIuL/wCLi/8Ai4v//6UA/wCLi/8Ai4v/AIuL//+lAP//pQD/AIuL//+lAP8Ai4v/\nAIuL/wCLi///pQD//6UA/wCLi///pQD//6UA/wCLi/8Ai4v//6UA//+lAP8Ai4v//6UA//+l\nAP8Ai4v/AIuL//+lAP//pQD/AIuL//+lAP8Ai4v//6UA//+lAP8Ai4v/AIuL//+lAP//pQD/\nAIuL//+lAP8Ai4v//6UA/wCLi///pQD//6UA/wCLi///pQD/AIuL/wCLi///pQD/AIuL//+l\nAP//pQD/AIuL//+lAP8Ai4v/AIuL//+lAP8Ai4v//6UA/wCLi///pQD/AIuL/wCLi///pQD/\nAIuL//+lAP//pQD/AIuL/wCLi///pQD/AIuL//+lAP//pQD/AIuL/wCLi///pQD/AIuL//+l\nAP8Ai4v//6UA//+lAP8Ai4v/AIuL//+lAP//pQD/AIuL/wCLi///pQD//6UA//+lAP8Ai4v/\n/6UA//+lAP//pQD/AIuL/wCLi/8Ai4v/AIuL//+lAP//pQD/AIuL//+lAP//pQD/AIuL//+l\nAP8Ai4v//6UA//+lAP8Ai4v//6UA//+lAP8Ai4v//6UA//+lAP8Ai4v/AIuL//+lAP//pQD/\n/6UA/wCLi/8Ai4v//6UA/wCLi/8Ai4v/AIuL//+lAP//pQD/AIuL//+lAP//pQD/AIuL//+l\nAP8Ai4v/AIuL//+lAP8Ai4v/AIuL//+lAP//pQD//6UA/wCLi/8Ai4v//6UA/wCLi///pQD/\nAIuL/wCLi///pQD/AIuL//+lAP//pQD/AIuL/wCLi///pQD//6UA/wCLi///pQD/AIuL//+l\nAP8Ai4v//6UA/wCLi///pQD/AIuL/wCLi///pQD/AIuL/wCLi/8Ai4v/AIuL/wCLi/8Ai4v/\n/6UA/wCLi/8Ai4v//6UA/wCLi///pQD//6UA/wCLi///pQD/AIuL//+lAP//pQD//6UA/wCL\ni/8Ai4v//6UA//+lAP8Ai4v//6UA/wCLi///pQD/AIuL/wCLi///pQD/AIuL//+lAP8Ai4v/\n/6UA/wCLi/8Ai4v//6UA/wCLi///pQD/AIuL//+lAP8Ai4v//6UA/wCLi///pQD/AIuL//+l\nAP//pQD/AIuL//+lAP//pQD/AIuL//+lAP8Ai4v/AIuL//+lAP//pQD/AIuL/wCLi///pQD/\nAIuL//+lAP8Ai4v//6UA//+lAP8Ai4v//6UA//+lAP8Ai4v/AIuL//+lAP//pQD//6UA/wCL\ni///pQD/AIuL/wCLi///pQD/AIuL//+lAP//pQD/AIuL/wCLi///pQD//6UA//+lAP8Ai4v/\nAIuL/wCLi///pQD//6UA/wCLi///pQD/AIuL//+lAP8Ai4v//6UA/wCLi///pQD/AIuL//+l\nAP8Ai4v//6UA//+lAP8Ai4v//6UA/wCLi/8Ai4v//6UA/wCLi/8Ai4v/AIuL/wCLi///pQD/\n/6UA/wCLi///pQD/AIuL//+lAP8Ai4v//6UA/wCLi///pQD//6UA/wCLi/8Ai4v//6UA//+l\nAP8Ai4v/AIuL//+lAP//pQD//6UA/wCLi/8Ai4v//6UA/wCLi///pQD//6UA/wCLi/8Ai4v/\n/6UA//+lAP//pQD/AIuL//+lAP8Ai4v//6UA/wCLi/8Ai4v//6UA/wCLi///pQD/AIuL/wCL\ni/8Ai4v//6UA//+lAP8Ai4v//6UA/wCLi///pQD/AIuL//+lAP8Ai4v//6UA//+lAP8Ai4v/\n/6UA/wCLi/8Ai4v//6UA/wCLi///pQD/AIuL//+lAP8Ai4v//6UA/wCLi/8Ai4v//6UA/wCL\ni///pQD/AIuL//+lAP8Ai4v//6UA//+lAP8Ai4v//6UA/wCLi/8Ai4v//6UA//+lAP8Ai4v/\n/6UA/wCLi///pQD//6UA/wCLi/8Ai4v//6UA//+lAP8Ai4v/AIuL//+lAP8Ai4v//6UA/wCL\ni///pQD//6UA//+lAP8Ai4v/AIuL//+lAP//pQD/AIuL//+lAP8Ai4v//6UA/wCLi///pQD/\n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\nwH8AAMB/AABgQAAAAAE="}]},"context":{"shiny":false,"rmarkdown":null},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG) || defined(USE_ENVMAP)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n// USE_ENVMAP implies NEEDS_VNORMAL\n\n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n\n#ifdef USE_ENVMAP\n  vReflection = normalize(reflect(vPosition.xyz/vPosition.w, \n                        normalize(vNormal.xyz/vNormal.w)));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n\n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i])\n        lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n\n// These calculations use the definitions from \n// https://docs.gl/gl3/glTexEnv\n\n#ifdef USE_ENVMAP\n    float m = 2.0 * sqrt(dot(vReflection, vReflection) + 2.0*vReflection.z + 1.0);\n    vec4 textureColor = texture2D(uSampler, vReflection.xy / m + vec2(0.5, 0.5));\n#else\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n#endif\n\n#ifdef TEXTURE_rgb\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(textureColor.rgb, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*vec4(textureColor.rgb, 1.);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb, lighteffect.a);\n#endif\n\n#endif //TEXTURE_rgb\n        \n#ifdef TEXTURE_rgba\n\n#ifdef TEXMODE_replace\n// already done\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*textureColor;\n#endif\n\n#ifdef TEXMODE_decal\n    textureColor = vec4((1. - textureColor.a)*lighteffect.rgb) +\n                     textureColor.a*textureColor.rgb, \n                     lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n    \n#endif //TEXTURE_rgba\n    \n#ifdef TEXTURE_alpha\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(lighteffect.rgb, textureColor.a);\n#endif \n\n#if defined(TEXMODE_modulate) || defined(TEXMODE_blend) || defined(TEXMODE_add)\n    textureColor = vec4(lighteffect.rgb, lighteffect.a*textureColor.a);\n#endif\n \n#endif\n    \n// The TEXTURE_luminance values are not from that reference    \n#ifdef TEXTURE_luminance\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, lighteffect.a);\n#endif\n\n#endif // TEXTURE_luminance\n \n    \n#ifdef TEXTURE_luminance_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, textureColor.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n\n#endif\n\n#endif // TEXTURE_luminance_alpha\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>&nbsp;</p>
</section>
</section>
<section id="reporting-with-quarto" class="level2">
<h2 class="anchored" data-anchor-id="reporting-with-quarto">Reporting with Quarto</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>As ever, I strongly recommend referring to <a href="https://quarto.org/docs/authoring/figures.html">the Quarto Guide</a> as the first stop for possibilities and/or problem-solving with Quarto.</p>
</div>
</div>
<p>In a previous section, we created a lovely scatterplot for a (hypothetical) linear model. Let’s see now how we could adjust the way that figure would appear in a Quarto document.</p>
<p>To begin, I’ve stored the final output for the LM plot we created above in a new object, <code>mcq_lm_plot</code>, to make the subsequent sections easier to read.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-24"><pre class="sourceCode r code-annotation-code code-with-copy"><code class="sourceCode r"><span id="annotated-cell-24-1"><a href="#annotated-cell-24-1" aria-hidden="true" tabindex="-1"></a>mcq_lm_plot <span class="ot">&lt;-</span> anx_scores_data <span class="sc">|&gt;</span></span>
<span id="annotated-cell-24-2"><a href="#annotated-cell-24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sticsa_trait_score, <span class="at">y =</span> sticsa_post_state_score,</span>
<span id="annotated-cell-24-3"><a href="#annotated-cell-24-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> mcq, <span class="at">fill =</span> mcq)) <span class="sc">+</span></span>
<span id="annotated-cell-24-4"><a href="#annotated-cell-24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="st">"jitter"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-24-5"><a href="#annotated-cell-24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-24-6"><a href="#annotated-cell-24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"STICSA Pre-MCQ State Anxiety Score"</span>,</span>
<span id="annotated-cell-24-7"><a href="#annotated-cell-24-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-24-8"><a href="#annotated-cell-24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"STICSA Post-MCQ State Anxiety Score"</span>,</span>
<span id="annotated-cell-24-9"><a href="#annotated-cell-24-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-24-10"><a href="#annotated-cell-24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis</span>(<span class="at">name =</span> <span class="st">"MCQ Type"</span>, <span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Maths"</span>, <span class="st">"Stats"</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-24-11"><a href="#annotated-cell-24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">name =</span> <span class="st">"MCQ Type"</span>, <span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Maths"</span>, <span class="st">"Stats"</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-24-12"><a href="#annotated-cell-24-12" aria-hidden="true" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>(<span class="at">box =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we’re just going to put our plot object in a new code chunk, in the document where we want it to appear. Equally, this could be the code that produces the plot; it doesn’t matter either way.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="in">mcq_lm_plot</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To change or add settings for a specific plot, we will use <em>code chunk options</em>, which we previously encountered in Tutorial 04. These options let us determine the way the code chunk behaves. Here, we’ll also see how we can use those code chunk options to style and format our plot.</p>
<section id="captions-and-alt-text" class="level3">
<h3 class="anchored" data-anchor-id="captions-and-alt-text">Captions and Alt Text</h3>
<p>First, we might add a <strong>caption</strong> to the plot, using the <code>fig-cap</code> option. You may have noticed that we didn’t give our plot a caption/title previously, and this is why. You can of course write whatever you like, but here’s an example.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Scatterplot of mean pre- and post-MCQ state anxiety scores"</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="in">mcq_lm_plot</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_dataviz_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Scatterplot of mean pre- and post-MCQ state anxiety scores</figcaption>
</figure>
</div>
</div>
</div>
<p>You should also add alt text to your figures to make them readable by screenreaders and other assistive technology. It is important to describe the insights from the visualisations clearly, such as the key patterns, connections, or findings, to ensure they are accessible. This <a href="https://medium.com/nightingale/writing-alt-text-for-data-visualization-2a218ef43f81">Medium article on scientific alt text</a> gives some clear guidelines for keeping alt text informative, brief, and useful.</p>
<p>We can add alt text to our figure using the <code>fig-alt</code> option:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Scatterplot of mean pre- and post-MCQ state anxiety scores"</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-alt: "Scatterplot of mean pre- and post-MCQ state anxiety scores showing a positive relationship, with separate linear regression lines for the two MCQ types both also showing a very similar positive relationship in both conditions"</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="in">mcq_lm_plot</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="cross-referencing" class="level3">
<h3 class="anchored" data-anchor-id="cross-referencing">Cross-Referencing</h3>
<p>As with tables, we can also include automatic cross-referencing for figures in our document. This means that Quarto will automatically number our figures and include links to those figures in the text of the document.</p>
<p>To do this, let’s first give our figure a <strong>label</strong>. Labels are essentially names for this particular figure that will allow us to refer to it in the text. In order to be recognised for cross-referencing, <strong>the label must start with the <code>fig-</code> prefix</strong>.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-mcq-lm</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Scatterplot of mean pre- and post-MCQ state anxiety scores"</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="in">mcq_lm_plot</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then, use this label with an <code>@</code> symbol in the text of the document to generate the cross-reference. For instance, I could write:</p>
<blockquote class="blockquote">
<p>The result of this analysis is visualised in <code>@fig-mcq-lm</code>.</p>
</blockquote>
<p>Which would appear when rendered as below - notice the caption now has “Figure 1” added to it to correspond to the in-text numbering.</p>
<blockquote class="blockquote">
<p>The result of this analysis is visualised in <a href="#fig-mcq-lm" class="quarto-xref">Figure&nbsp;1</a>.</p>
</blockquote>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mcq-lm" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mcq-lm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07_dataviz_files/figure-html/fig-mcq-lm-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mcq-lm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Scatterplot of mean pre- and post-MCQ state anxiety scores
</figcaption>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Very well done on your hard work so far. We’ll keep using our {ggplot2} chops when we dig into analysis next week, and see how we can easily create plots to accompany those analyses using built-in functions.</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>You may notice a certain commonality to the colour theme of this website!<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Yes, this is not <em>technically</em> true because the values can only be whole numbers between 0 and 5, but what matters here is that <em>R</em> thinks this is continuous data.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>See e.g.&nbsp;<a href="https://www.sciencedirect.com/science/article/pii/S0010027708000978?casa_token=6uU795RgZ4wAAAAA:NopLcy7IaTM1YyHXQZ7d3YSjDdV0-WOBJ208crznaivMxdR4AaUtXDMIgXvMZ0LvaRhwyTEBdg">Shaki and Fischer, 2008</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Tragically, <code>geom_scatter()</code> isn’t a thing, not matter how many times I try!<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Naturally, if you want to use palettes from a different package, you’ll need to use the functions from that package instead! Those functions may also work a bit differently, so make sure you read the help documentation if you get stuck.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© Jennifer Mankin 2024</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>