<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R Training - 07: Summarise</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">R Training</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../tutorials.html" aria-current="page"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../workshops.html"> 
<span class="menu-text">Workshops</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://canvas.sussex.ac.uk/courses/29761"> 
<span class="menu-text">Canvas</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../tutorials/docs/01_intro.html">Current</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs/07_summarise.html">07: Summarise</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorials Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quick_ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quick Reference</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Current</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01: IntRoduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/02_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02: IntRoduction II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/03_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03: Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/04_filter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04: Filter and Select</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/05_mutate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05: Mutate</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/06_lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06: Reproducible Linear Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/07_summarise.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">07: Summarise</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/08_dataviz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08: Visualisations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/09_qtrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09: Labelled Data and Qualtrics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs/10_reproducibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10: Putting it all together</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Archive (Autumn 2023)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/00_quick_ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quick Reference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/01_02_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01/02: IntRoduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/03_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03: Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/04_lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04: Reporting Linear Models with Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/05_filter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05: Filter and Select</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06: Mutate and Summarise</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/07_dataviz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07: Visualisations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/08_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08: Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/09_testflight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09: Test Flight</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/10_qtrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10: Qualtrics and Labelled Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/archive_autumn_2023/11_qtrics2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11: Qualtrics II</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a>
  <ul>
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#codebook" id="toc-codebook" class="nav-link" data-scroll-target="#codebook">Codebook</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#summarising" id="toc-summarising" class="nav-link" data-scroll-target="#summarising">Summarising</a>
  <ul>
  <li><a href="#overall" id="toc-overall" class="nav-link" data-scroll-target="#overall">Overall</a>
  <ul class="collapse">
  <li><a href="#internal-calculations" id="toc-internal-calculations" class="nav-link" data-scroll-target="#internal-calculations">Internal Calculations</a></li>
  </ul></li>
  <li><a href="#by-group" id="toc-by-group" class="nav-link" data-scroll-target="#by-group">By Group</a></li>
  <li><a href="#multiple-variables" id="toc-multiple-variables" class="nav-link" data-scroll-target="#multiple-variables">Multiple Variables</a>
  <ul class="collapse">
  <li><a href="#use-an-existing-function" id="toc-use-an-existing-function" class="nav-link" data-scroll-target="#use-an-existing-function">Use an Existing Function</a></li>
  <li><a href="#iteration" id="toc-iteration" class="nav-link" data-scroll-target="#iteration">Iteration</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  <li><a href="#formatting-tables" id="toc-formatting-tables" class="nav-link" data-scroll-target="#formatting-tables">Formatting Tables</a>
  <ul>
  <li><a href="#quarto-to-htmlpdf" id="toc-quarto-to-htmlpdf" class="nav-link" data-scroll-target="#quarto-to-htmlpdf">Quarto to HTML/PDF</a></li>
  <li><a href="#exporting" id="toc-exporting" class="nav-link" data-scroll-target="#exporting">Exporting</a>
  <ul class="collapse">
  <li><a href="#creating-a-folder" id="toc-creating-a-folder" class="nav-link" data-scroll-target="#creating-a-folder">Creating a Folder</a></li>
  <li><a href="#exporting-1" id="toc-exporting-1" class="nav-link" data-scroll-target="#exporting-1">Exporting</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#quick-test-correlation" id="toc-quick-test-correlation" class="nav-link" data-scroll-target="#quick-test-correlation">Quick Test: Correlation</a>
  <ul>
  <li><a href="#visualisation" id="toc-visualisation" class="nav-link" data-scroll-target="#visualisation">Visualisation</a></li>
  <li><a href="#testing-correlation" id="toc-testing-correlation" class="nav-link" data-scroll-target="#testing-correlation">Testing Correlation</a></li>
  </ul></li>
  <li><a href="#exercises-1" id="toc-exercises-1" class="nav-link" data-scroll-target="#exercises-1">Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../tutorials/docs/01_intro.html">Current</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs/07_summarise.html">07: Summarise</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">07: Summarise</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This tutorial focuses on the {dplyr} function <code>summarise()</code> for creating summaries of datasets, alongside the helper function <code>group_by()</code> that allows new variables or summaries to be created within subgroups.</p>
<p>We will also explore how to turn those summary tables into nicely formatted tables, both within and outside of Quarto documents/the R ecosystem.</p>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<section id="packages" class="level3">
<h3 class="anchored" data-anchor-id="packages">Packages</h3>
<p>We will again be focusing on {dplyr} today, which contains both of our main functions. You can either load {dplyr} alone, or all of {tidyverse} - it won’t make a difference, but you only need one or the other.</p>
<p>We’ll also need {GGally} for correlograms, {correlation} for, well, I’ll give you three guesses!, and {kableExtra} for table formatting.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Load the necessary packages.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## OR</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(correlation)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<p>Today we’re continuing to work with the same dataset as last week. Courtesy of fantastic Sussex colleague <a href="https://www.jennyterry.co.uk/">Jenny Terry</a>, this dataset contains real data about statistics and maths anxiety.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Read in the dataset and save it in a new object, <code>anx_scores</code>.</p>
<p>On the Cloud, you can read in this dataset from the <code>data</code> folder using <code>here::here()</code>.</p>
<p>Elsewhere, you can download the dataset, or copy the dataset URL, from the <a href="../../../data_workbooks.qmd">Data and Workbooks page</a>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Read in from file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/anx_scores_data.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Read in from URL:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/drmankin/practicum/master/data/anx_scores_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="codebook" class="level4">
<h4 class="anchored" data-anchor-id="codebook">Codebook</h4>
<p>This dataset is an updated version of the <code>anx_data</code> dataset we were working with previously. Since we covered recoding scores and calculating composites in the tutorial on <code>mutate()</code>, this dataset contains subscale scores for the various questionnaires, rather than individual item scores.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Dataset Info Recap">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dataset Info Recap
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This study explored the difference between maths and statistics anxiety, widely assumed to be different constructs. Participants completed the Statistics Anxiety Rating Scale (<a href="https://explore.bps.org.uk/content/bpsptr/24/2/101">STARS</a>) and Maths Anxiety Rating Scale - Revised (<a href="https://journals.sagepub.com/doi/10.1177/001316448204200218">R-MARS</a>), as well as modified versions, the STARS-M and R-MARS-S. In the modified versions of the scales, references to statistics and maths were swapped; for example, the STARS item “Studying for an examination in a statistics course” became the STARS-M item “Studying for an examination in a maths course”; and the R-MARS item “Walking into a maths class” because the R-MARS-S item “Walking into a statistics class”.</p>
<p>Participants also completed the State-Trait Inventory for Cognitive and Somatic Anxiety (<a href="https://www.cambridge.org/core/journals/behavioural-and-cognitive-psychotherapy/article/abs/distinguishing-cognitive-and-somatic-dimensions-of-state-and-trait-anxiety-development-and-validation-of-the-statetrait-inventory-for-cognitive-and-somatic-anxiety-sticsa/78FDDC5BCDE9D4164434AC10E83DCEF3?utm_campaign=shareaholic&amp;utm_medium=copy_link&amp;utm_source=bookmark">STICSA</a>). They completed the state anxiety items twice: once before, and once after, answering a set of five MCQ questions. These MCQ questions were either about maths, or about statistics; each participant only saw one of the two MCQ conditions.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>For learning purposes, I’ve randomly generated some additional variables to add to the dataset containing info on distribution channel, consent, gender, and age. Especially for the consent variable, don’t worry: all the participants in this dataset did consent to the original study. I’ve simulated and added this variable in later to practice removing participants.</p>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="View the Codebook">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View the Codebook
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Description</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">Unique ID code</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">distribution</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">Channel through which the study was completed, either as a preview (before real data collection) or anonymous genuine responses. Note that this variable has been randomly generated and does NOT reflect genuine responses.</td>
<td style="text-align: left;">"preview" or "anonymous"</td>
</tr>
<tr class="odd">
<td style="text-align: left;">consent</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">Whether the participant read and consented to participate. Note that this variable has been randomly generated and does NOT reflect genuine responses; all participants in this dataset did originally consent to participate.</td>
<td style="text-align: left;">"Yes" or "No"</td>
</tr>
<tr class="even">
<td style="text-align: left;">gender</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">Gender identity. Note that this variable has been randomly generated and does NOT reflect genuine responses.</td>
<td style="text-align: left;">"female", "male", "non-binary", or "other/pnts". "pnts" is an abbreviation for "Prefer not to say".</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Age in years. Note that this variable has been randomly generated and does NOT reflect genuine responses.</td>
<td style="text-align: left;">18 - 99</td>
</tr>
<tr class="even">
<td style="text-align: left;">mcq</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">Independent variable for MCQ question condition, whether the participant saw MCQ questions about mathematics or statistics.</td>
<td style="text-align: left;">"maths" or "stats"</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stars_test_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Test Anxiety subscale of the Statistics Anxiety Rating Scale (STARS)</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="even">
<td style="text-align: left;">stars_int_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Interpretation Anxiety subscale of the Statistics Anxiety Rating Scale (STARS)</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stars_help_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Asking for Help subscale of the Statistics Anxiety Rating Scale (STARS)</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="even">
<td style="text-align: left;">stars_m_test_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Test Anxiety subscale of the Statistics Anxiety Rating Scale - Maths (STARS-M), a modified version of the STARS with all references to maths replaced with statistics.</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stars_m_int_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Interpretation Anxiety subscale of the Statistics Anxiety Rating Scale - Maths (STARS-M), a modified version of the STARS with all references to maths replaced with statistics.</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="even">
<td style="text-align: left;">stars_m_help_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Asking for Help subscale of the Statistics Anxiety Rating Scale - Maths (STARS-M), a modified version of the STARS with all references to maths replaced with statistics.</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rmars_test_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Test Anxiety subscale of the Revised Maths Anxiety Rating Scale (R-MARS)</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="even">
<td style="text-align: left;">rmars_num_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Numerical Task Anxiety subscale of the Revised Maths Anxiety Rating Scale (R-MARS)</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rmars_course_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Course Anxiety subscale of the Revised Maths Anxiety Rating Scale (R-MARS)</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="even">
<td style="text-align: left;">rmars_s_test_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Test Anxiety subscale of the Revised Maths Anxiety Rating Scale - Statistics (R-MARS-S), a modified version of the MARS with all references to maths replaced with statistics.</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rmars_s_num_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Numerical Anxiety subscale of the Revised Maths Anxiety Rating Scale - Statistics (R-MARS-S), a modified version of the MARS with all references to maths replaced with statistics.</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="even">
<td style="text-align: left;">rmars_s_course_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Course Anxiety subscale of the Revised Maths Anxiety Rating Scale - Statistics (R-MARS-S), a modified version of the MARS with all references to maths replaced with statistics.</td>
<td style="text-align: left;">1 (low anxiety) to 5 (high anxiety)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sticsa_trait_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the Trait Anxiety subscale of the State-Trait Inventory for Cognitive and Somatic Anxiety.</td>
<td style="text-align: left;">1 (not at all) to 4 (very much so)</td>
</tr>
<tr class="even">
<td style="text-align: left;">sticsa_pre_state_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the State Anxiety subscale of the State-Trait Inventory for Cognitive and Somatic Anxiety, pre-MCQ.</td>
<td style="text-align: left;">1 (not at all) to 4 (very much so)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sticsa_post_state_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Averaged score on the State Anxiety subscale of the State-Trait Inventory for Cognitive and Somatic Anxiety, post-MCQ.</td>
<td style="text-align: left;">1 (not at all) to 4 (very much so)</td>
</tr>
<tr class="even">
<td style="text-align: left;">mcq_score</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Total (summed) score on the MCQ questions.</td>
<td style="text-align: left;">0 (all incorrect) to 5 (all correct)</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="summarising" class="level2">
<h2 class="anchored" data-anchor-id="summarising">Summarising</h2>
<p>The <code>summarise()</code> function looks almost exactly like <code>mutate()</code>, which was covered in the previous tutorial. The difference is that <code>mutate()</code> creates or replaces variables within the <strong>same</strong> dataset, while <code>summarise()</code> creates a <strong>new</strong> summary dataset without changing the original.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dataset_name <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable_name =</span> instructions_for_creating_the_variable</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>variable_name</code> is the name of a variable that will be created in the new summary tibble. This can be any name that follows R’s object naming rules.</p>
<p><code>instructions_for_creating_the_variable</code> tells the function how to create <code>variable_name</code>. The instructions can refer to variables in the piped-in dataset, but should output a <strong>single value</strong>, rather than a vector of values (as we saw in <code>mutate()</code>).</p>
<section id="overall" class="level3">
<h3 class="anchored" data-anchor-id="overall">Overall</h3>
<p>Let’s have a look at an example of this. We looked previously at <code>sticsa_trait_score</code>, so we might want to get some summary info about this variable, such as the mean and standard deviation. To do this, we create a new variable for each descriptive value we want to create on the left side of the <code>=</code>, and instructions for creating that summary on the right.</p>
<p>To help us out with our summaries, we’ll also bundle in a bonus new function while we’re at it. Unassuming little <code>dplyr::n()</code> has one job: counting the number of cases. Right now it’s not telling us much that’s new…but that will change in a bit!</p>
<p>Putting that all together, here’s an example of how that works:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-2-1" class="code-annotation-target"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span></span>
<span id="annotated-cell-2-2"><a href="#annotated-cell-2-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-2-3" class="code-annotation-target"><a href="#annotated-cell-2-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-2-4" class="code-annotation-target"><a href="#annotated-cell-2-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_mean =</span> <span class="fu">mean</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-2-5" class="code-annotation-target"><a href="#annotated-cell-2-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_sd =</span> <span class="fu">sd</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-2-6"><a href="#annotated-cell-2-6" aria-hidden="true" tabindex="-1"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="1,2" data-code-annotation="1">Take the dataset <code>anx_scores</code>, <em>and then</em> produce a summary as follows:</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="3" data-code-annotation="2">Count the number of cases and store it in the variable <code>n</code></span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="4" data-code-annotation="3">Calculate the mean of the <code>sticsa_trait_score</code> variable (ignoring any missing values) and store it in the variable <code>sticsa_trait_mean</code></span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="5" data-code-annotation="4">Calculate the standard deviation of the <code>sticsa_trait_score</code> variable (ignoring any missing values) and store it in the variable <code>sticsa_trait_sd</code></span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["n"],"name":[1],"type":["int"],"align":["right"]},{"label":["sticsa_trait_mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_sd"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"465","2":"2.20824","3":"0.6291805"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<section id="internal-calculations" class="level4">
<h4 class="anchored" data-anchor-id="internal-calculations">Internal Calculations</h4>
<p>A very useful feature of these functions - both <code>mutate()</code> and <code>summarise()</code> - is that once you create a variable within the function, you can use it in subsequent arguments to that function.</p>
<p>For instance, let’s say we want to include standard error in our summary as well. Unfortunately there’s no base <code>se()</code> function (along the lines of <code>sd()</code>). There are functions in other packages, such as <code>papaja::se()</code>, that you could find by searching for “standard error” in the Help tab (in the Files pane); but it might not always be a good idea to use single functions from other packages, since you will have to (remember to) install/update those packages. This would be worth it if that function did an operation that would otherwise be difficult or labor-intensive to replicate, but in this case, standard error is a straightforward mathematical operation: namely, the standard deviation divided by the square root of <em>N</em>. We’ve already created a variable that contains the <em>SD</em>, and we have the dataset and we know how to count the number of cases so, let’s just do it by hand.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-3"><pre class="sourceCode r code-annotation-code code-with-copy"><code class="sourceCode r"><span id="annotated-cell-3-1"><a href="#annotated-cell-3-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span></span>
<span id="annotated-cell-3-2"><a href="#annotated-cell-3-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="annotated-cell-3-3"><a href="#annotated-cell-3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="annotated-cell-3-4"><a href="#annotated-cell-3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_mean =</span> <span class="fu">mean</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-3-5"><a href="#annotated-cell-3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_sd =</span> <span class="fu">sd</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-3-6"><a href="#annotated-cell-3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_se =</span> sticsa_trait_sd<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="annotated-cell-3-7"><a href="#annotated-cell-3-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["n"],"name":[1],"type":["int"],"align":["right"]},{"label":["sticsa_trait_mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_sd"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_se"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"465","2":"2.20824","3":"0.6291805","4":"0.02917755"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>In the last line creating <code>sticsa_trait_se</code>, both <code>sticsa_trait_sd</code> and <code>n</code> are variables created previously in the same <code>summarise()</code> command. So, the new variables in <code>summarise()</code> are immediately available on subsequent lines to use in further calculations.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="MoRe About: Code Order">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
MoRe About: Code Order
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>It’s important to note from the above that the new variables created are immediately available in <em>subsequent</em> lines. As always, it’s essential to remember that code is ordered sequentially. The same lines within <code>summarise()</code> will not evaluate correctly if they are out of order:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-16"><pre class="sourceCode r code-annotation-code code-with-copy"><code class="sourceCode r"><span id="annotated-cell-16-1"><a href="#annotated-cell-16-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span></span>
<span id="annotated-cell-16-2"><a href="#annotated-cell-16-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="annotated-cell-16-3"><a href="#annotated-cell-16-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="annotated-cell-16-4"><a href="#annotated-cell-16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_mean =</span> <span class="fu">mean</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-16-5"><a href="#annotated-cell-16-5" aria-hidden="true" tabindex="-1"></a>    <span class="do">## SE line moved up before SD line</span></span>
<span id="annotated-cell-16-6"><a href="#annotated-cell-16-6" aria-hidden="true" tabindex="-1"></a>    <span class="do">## So attempting to use sticsa_trait_sd` before it is created</span></span>
<span id="annotated-cell-16-7"><a href="#annotated-cell-16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_se =</span> sticsa_trait_sd<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="annotated-cell-16-8"><a href="#annotated-cell-16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_sd =</span> <span class="fu">sd</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="annotated-cell-16-9"><a href="#annotated-cell-16-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="annotated-cell-16-10"><a href="#annotated-cell-16-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `dplyr::summarise()`:
ℹ In argument: `sticsa_trait_se = sticsa_trait_sd/sqrt(n)`.
Caused by error:
! object 'sticsa_trait_sd' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="by-group" class="level3">
<h3 class="anchored" data-anchor-id="by-group">By Group</h3>
<p>Next, let’s combine <code>dplyr::summarise()</code> with the helper function <code>dplyr::group_by()</code> to split up the summary calculations by the values of a grouping variable.</p>
<p>Similar to <a href="../../tutorials/docs/05_mutate.html#composite-scores">what we saw with <code>rowwise()</code></a>, <code>group_by()</code> creates an internal structure in the dataset: a new group for each unique value in the grouping variable. Any subsequent calculations done with the dataset are done within those groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-4-1" class="code-annotation-target"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-4-2" class="code-annotation-target"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(mcq) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-4-3" class="code-annotation-target"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-4-4" class="code-annotation-target"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="annotated-cell-4-5"><a href="#annotated-cell-4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_mean =</span> <span class="fu">mean</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-4-6"><a href="#annotated-cell-4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_sd =</span> <span class="fu">sd</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-4-7"><a href="#annotated-cell-4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_se =</span> sticsa_trait_sd<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="annotated-cell-4-8"><a href="#annotated-cell-4-8" aria-hidden="true" tabindex="-1"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="1" data-code-annotation="1">Take the dataset, <em>and then</em></span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="2" data-code-annotation="2">Group by the values in the <code>mcq</code> variable, <em>and then</em></span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="3" data-code-annotation="3">Produce a summary table with the following variables:</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="4,5,6,7" data-code-annotation="4">Number of cases, mean, <em>SD</em>, and <em>SE</em> of the <code>sticsa_trait_score</code> variable.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mcq"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]},{"label":["sticsa_trait_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_se"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"maths","2":"233","3":"2.168437","4":"0.6462829","5":"0.04233940"},{"1":"stats","2":"232","3":"2.248214","4":"0.6103040","5":"0.04006842"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Compare this to the ungrouped summary in the previous section - it’s the same columns, but a new row for each group. We also see here that little <code>dplyr::n()</code> is a bit more useful now - giving us counts within each group alongside the other summary information, which also means that the standard error can be calculated for each group separately as well.</p>
</section>
<section id="multiple-variables" class="level3">
<h3 class="anchored" data-anchor-id="multiple-variables">Multiple Variables</h3>
<p>Despite the versatility of <code>summarise()</code>, you may have already noticed that the code covered so far is very typing-intensive if you want information about more than one variable. This is neither efficient nor particularly enjoyable to write, read, or use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-5"><pre class="sourceCode r code-annotation-code code-with-copy"><code class="sourceCode r"><span id="annotated-cell-5-1"><a href="#annotated-cell-5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Down with this sort of thing!</span></span>
<span id="annotated-cell-5-2"><a href="#annotated-cell-5-2" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span></span>
<span id="annotated-cell-5-3"><a href="#annotated-cell-5-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(mcq) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-5-4"><a href="#annotated-cell-5-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="annotated-cell-5-5"><a href="#annotated-cell-5-5" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Summary info about stica_trait_score</span></span>
<span id="annotated-cell-5-6"><a href="#annotated-cell-5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_mean =</span> <span class="fu">mean</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-5-7"><a href="#annotated-cell-5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_sd =</span> <span class="fu">sd</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-5-8"><a href="#annotated-cell-5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_se =</span> sticsa_trait_sd<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="annotated-cell-5-9"><a href="#annotated-cell-5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_min =</span> <span class="fu">min</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-5-10"><a href="#annotated-cell-5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_max =</span> <span class="fu">max</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-5-11"><a href="#annotated-cell-5-11" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Summary info about stars_test_score</span></span>
<span id="annotated-cell-5-12"><a href="#annotated-cell-5-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">stars_test_mean =</span> <span class="fu">mean</span>(stars_test_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-5-13"><a href="#annotated-cell-5-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">stars_test_sd =</span> <span class="fu">sd</span>(stars_test_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-5-14"><a href="#annotated-cell-5-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">stars_test_se =</span> sticsa_trait_sd<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="annotated-cell-5-15"><a href="#annotated-cell-5-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">stars_test_min =</span> <span class="fu">min</span>(stars_test_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-5-16"><a href="#annotated-cell-5-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">stars_test_max =</span> <span class="fu">max</span>(stars_test_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="annotated-cell-5-17"><a href="#annotated-cell-5-17" aria-hidden="true" tabindex="-1"></a>    <span class="do">## And so on...</span></span>
<span id="annotated-cell-5-18"><a href="#annotated-cell-5-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we wanted to also include, for instance, range and CIs, this code would quickly become unmanageably long and difficult to read, not to mention increasingly prone to copy/paste and find/replace mistakes. (I’ve actually made one above - can you spot it?)</p>
<p>Remember, if you have to copy/paste more than once, <strong>use a function instead.</strong></p>
<p>There are two main solutions to this issue, and which you choose depends on what you want the output to contain and how much work you want to put into reading the help documentation of various functions.</p>
<section id="use-an-existing-function" class="level4">
<h4 class="anchored" data-anchor-id="use-an-existing-function">Use an Existing Function</h4>
<div class="callout callout-style-default callout-important callout-titled" title="Choose this option if:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Choose this option if:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>You just want standard descriptives</li>
<li>You don’t mind reading up in the help documentation to get the right combination of arguments, and/or trying out a few different functions/packages to find the one that works for you.</li>
</ul>
</div>
</div>
<p>As we saw in <a href="../../tutorials/docs/03_datasets.html#overall-summaries">Tutorial 03</a>, there are existing functions that output pre-made summaries across multiple variables. If you revisit <code>datawizard::describe_distribution()</code>, you will find in the help documentation that it can utilise <code>&lt;tidyselect&gt;</code> syntax to select the variables you want, and the output can even be forced into a tibble for further wrangling.</p>
</section>
<section id="iteration" class="level4">
<h4 class="anchored" data-anchor-id="iteration">Iteration</h4>
<div class="callout callout-style-default callout-important callout-titled" title="Choose this option if:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Choose this option if:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>You want custom or complex summary information</li>
<li>You want grouped summaries</li>
<li>You just want to do everything yourself so you know it’s exactly right.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>This material may not be covered in the live workshops, depending on time. It’s included here for reference because it’s extremely useful in real R analysis workflows, but it won’t be essential for any of the workshop tasks.</p>
</div>
</div>
<p>The big, inefficient multi-variable <code>summarise()</code> command above has two main issues to resolve.</p>
<ol type="1">
<li>We had to type the same functions over and over (i.e.&nbsp;<code>mean()</code> and <code>sd()</code> are repeated for each variable).</li>
<li>We had to manually type in each variable name we want to use (i.e.&nbsp;<code>sticsa_trait_mean = ..., sticsa_trait_sd = ...</code>)</li>
</ol>
<p>To solve the first issue, we’ll <strong>create a list of functions</strong> to use, so we only have to type out each function once. To solve the second, we’re going to utilise <code>dplyr::across()</code> to <strong>apply that list of functions</strong> to variables selected with <code>&lt;tidyselect&gt;</code>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For more explanation about <code>dplyr::across()</code>, see the <a href="../../tutorials/docs/05_mutate.html#iteration">section on iteration with <code>mutate()</code></a> earlier on. For a much more in-depth explanation, run <code>vignette("colwise")</code> in the Console.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-6-1" class="code-annotation-target"><a href="#annotated-cell-6-1" aria-hidden="true" tabindex="-1"></a>fns <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-6-2" class="code-annotation-target"><a href="#annotated-cell-6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="sc">~</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="annotated-cell-6-3"><a href="#annotated-cell-6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-6-4"><a href="#annotated-cell-6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> <span class="sc">~</span> <span class="fu">sd</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-6-5"><a href="#annotated-cell-6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="sc">~</span> <span class="fu">sd</span>(.x, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span>dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="annotated-cell-6-6"><a href="#annotated-cell-6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">min =</span> <span class="sc">~</span> <span class="fu">min</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-6-7"><a href="#annotated-cell-6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">max =</span> <span class="sc">~</span> <span class="fu">max</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="annotated-cell-6-8"><a href="#annotated-cell-6-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="annotated-cell-6-9"><a href="#annotated-cell-6-9" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-6-10" class="code-annotation-target"><a href="#annotated-cell-6-10" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span></span>
<span id="annotated-cell-6-11"><a href="#annotated-cell-6-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(mcq) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-6-12"><a href="#annotated-cell-6-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-6-13" class="code-annotation-target"><a href="#annotated-cell-6-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="annotated-cell-6-14"><a href="#annotated-cell-6-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols =</span> <span class="fu">contains</span>(<span class="st">"stars"</span>),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-6-15" class="code-annotation-target"><a href="#annotated-cell-6-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns =</span> fns</span>
<span id="annotated-cell-6-16"><a href="#annotated-cell-6-16" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="annotated-cell-6-17"><a href="#annotated-cell-6-17" aria-hidden="true" tabindex="-1"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="1" data-code-annotation="1">Create an object (here <code>fns</code> short for “functions”) that contains a list of…</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="2,3,4,5,6,7" data-code-annotation="2">Named elements, each of which contains a function written as a <code>purrr</code>-style lambda.</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="10,11,12" data-code-annotation="3">Take the <code>anx_scores</code> data, <em>and then</em> group by MCQ type, <em>and then</em> summarise it as follows:</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="13,14" data-code-annotation="4">Across all of the variables in the <code>anx_score</code> dataset whose names contain the string “stars”,</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="15" data-code-annotation="5">Apply the list of functions stored in the <code>fns</code> object.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mcq"],"name":[1],"type":["chr"],"align":["left"]},{"label":["stars_test_score_n"],"name":[2],"type":["int"],"align":["right"]},{"label":["stars_test_score_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["stars_test_score_sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["stars_test_score_se"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["stars_test_score_min"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["stars_test_score_max"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["stars_int_score_n"],"name":[8],"type":["int"],"align":["right"]},{"label":["stars_int_score_mean"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["stars_int_score_sd"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["stars_int_score_se"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["stars_int_score_min"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["stars_int_score_max"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["stars_help_score_n"],"name":[14],"type":["int"],"align":["right"]},{"label":["stars_help_score_mean"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["stars_help_score_sd"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["stars_help_score_se"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["stars_help_score_min"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["stars_help_score_max"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["stars_m_test_score_n"],"name":[20],"type":["int"],"align":["right"]},{"label":["stars_m_test_score_mean"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["stars_m_test_score_sd"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["stars_m_test_score_se"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["stars_m_test_score_min"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["stars_m_test_score_max"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["stars_m_int_score_n"],"name":[26],"type":["int"],"align":["right"]},{"label":["stars_m_int_score_mean"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["stars_m_int_score_sd"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["stars_m_int_score_se"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["stars_m_int_score_min"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["stars_m_int_score_max"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["stars_m_help_score_n"],"name":[32],"type":["int"],"align":["right"]},{"label":["stars_m_help_score_mean"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["stars_m_help_score_sd"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["stars_m_help_score_se"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["stars_m_help_score_min"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["stars_m_help_score_max"],"name":[37],"type":["dbl"],"align":["right"]}],"data":[{"1":"maths","2":"233","3":"3.410178","4":"0.9066354","5":"0.003891139","6":"1.125","7":"5","8":"233","9":"2.631369","10":"0.8893695","11":"0.003817036","12":"1","13":"5.000000","14":"233","15":"2.737124","16":"1.141802","17":"0.004900440","18":"1","19":"5","20":"233","21":"3.307174","22":"0.9315164","23":"0.003997925","24":"1","25":"5","26":"233","27":"2.583308","28":"0.9414150","29":"0.004040408","30":"1","31":"5.000","32":"233","33":"2.710658","34":"1.117205","35":"0.004794870","36":"1","37":"5"},{"1":"stats","2":"232","3":"3.432497","4":"0.8198152","5":"0.003533686","6":"1.250","7":"5","8":"232","9":"2.574334","10":"0.8258294","11":"0.003559609","12":"1","13":"4.818182","14":"232","15":"2.927443","16":"1.102739","17":"0.004753185","18":"1","19":"5","20":"232","21":"3.274169","22":"0.8708616","23":"0.003753714","24":"1","25":"5","26":"232","27":"2.443812","28":"0.8321152","29":"0.003586703","30":"1","31":"4.875","32":"232","33":"2.791667","34":"1.041295","35":"0.004488341","36":"1","37":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>To recap briefly, the elements in the <code>fns</code> list have a special format. The first bit, e.g.&nbsp;<code>mean =</code>, gives each element a name. This name will be appended to the relevant column in the <code>summarise()</code> output, so choose something informative and brief. (Here the formulae are named the same as their functions, but this doesn’t have to be the case.) The second bit, e.g.&nbsp;<code>~ mean(.x, na.rm = TRUE)</code>, is the function we want to apply to each variable. The two things to note are the “twiddle” <code>~</code>, which denotes “this is a function to apply”, and <code>.x</code>, which is a placeholder for each of the variables that the function will be applied to.</p>
<p>Within <code>across()</code>, we are building on what we’ve seen before with this function. The first argument, <code>.cols</code>, selects which variables (columns) to use, using <code>&lt;tidyselect&gt;</code> or any other <code>select()</code> syntax. In this case, I’ve selected all of the variables that contain the string “stars”. The second argument provides a list of function(s) to apply to all of the selected variables, which here is the <code>fns</code> object.</p>
<p>This function list + <code>dplyr::across()</code> method is extremely versatile. If you are using a lesser-known statistical technique, or even functions of your own making, you can easily add them to your list of functions and apply them with <code>across()</code>.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="MoRe About: Function Lists">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
MoRe About: Function Lists
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As a final note here, the creation of the <code>fns</code> object containing a list of functions isn’t technically necessary - you can just provide the list in <code>across</code> directly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-18"><pre class="sourceCode r code-annotation-code code-with-copy"><code class="sourceCode r"><span id="annotated-cell-18-1"><a href="#annotated-cell-18-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span></span>
<span id="annotated-cell-18-2"><a href="#annotated-cell-18-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(mcq) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-18-3"><a href="#annotated-cell-18-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="annotated-cell-18-4"><a href="#annotated-cell-18-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="annotated-cell-18-5"><a href="#annotated-cell-18-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">contains</span>(<span class="st">"stars"</span>),</span>
<span id="annotated-cell-18-6"><a href="#annotated-cell-18-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="annotated-cell-18-7"><a href="#annotated-cell-18-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="annotated-cell-18-8"><a href="#annotated-cell-18-8" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="annotated-cell-18-9"><a href="#annotated-cell-18-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mcq"],"name":[1],"type":["chr"],"align":["left"]},{"label":["stars_test_score_mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["stars_int_score_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["stars_help_score_mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["stars_m_test_score_mean"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["stars_m_int_score_mean"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["stars_m_help_score_mean"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"maths","2":"3.410178","3":"2.631369","4":"2.737124","5":"3.307174","6":"2.583308","7":"2.710658"},{"1":"stats","2":"3.432497","3":"2.574334","4":"2.927443","5":"3.274169","6":"2.443812","7":"2.791667"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Personally, I would prefer to make a separate object for three reasons:</p>
<ol type="1">
<li>I could reuse the same list of functions later on in my code without having to copy/paste.</li>
<li>I can update that single list of functions to update any summaries created with it.</li>
<li>The code is cleaner and easier to read, especially the <code>across()</code> command.</li>
</ol>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Starting with the example code from previously:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-19"><pre class="sourceCode r code-annotation-code code-with-copy"><code class="sourceCode r"><span id="annotated-cell-19-1"><a href="#annotated-cell-19-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span></span>
<span id="annotated-cell-19-2"><a href="#annotated-cell-19-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(mcq) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-19-3"><a href="#annotated-cell-19-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="annotated-cell-19-4"><a href="#annotated-cell-19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="annotated-cell-19-5"><a href="#annotated-cell-19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_mean =</span> <span class="fu">mean</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-19-6"><a href="#annotated-cell-19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_sd =</span> <span class="fu">sd</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-19-7"><a href="#annotated-cell-19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_se =</span> sticsa_trait_sd<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="annotated-cell-19-8"><a href="#annotated-cell-19-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mcq"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]},{"label":["sticsa_trait_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_se"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"maths","2":"233","3":"2.168437","4":"0.6462829","5":"0.04233940"},{"1":"stats","2":"232","3":"2.248214","4":"0.6103040","5":"0.04006842"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Make the following changes:</p>
<ul>
<li>Add the min and max of <code>sticsa_trait_score</code> to the summary.</li>
<li>Split up the summary by gender as well as MCQ group.</li>
</ul>
<p>Save your final summary table as <code>anx_scores_sum</code>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For the first, add new lines within <code>summarise()</code> using the <code>min()</code> and <code>max()</code> functions we’ve encountered previously.</p>
<p>For the second, add the <code>gender</code> variable to <code>group_by()</code> to subdivide the summary output.</p>
<p>Finally, add the new object name and assignment operator to the beginning of the code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>anx_scores_sum <span class="ot">&lt;-</span> anx_scores <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(mcq, gender) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_mean =</span> <span class="fu">mean</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_sd =</span> <span class="fu">sd</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_se =</span> sticsa_trait_sd<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_min =</span> <span class="fu">min</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_max =</span> <span class="fu">max</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>CHALLENGE</strong>: Instead of MCQ and gender, split up the summary information of <code>sticsa_trait_score</code> by whether each case scored higher, or lower than/equal to, the median value of the STARS test anxiety score.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You could have solved this in (at least) two ways. The first is to have an intermediate <code>mutate()</code> command to create the grouping variable, which doesn’t yet exist in the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Create the new stars_test_cat</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">stars_test_cat =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>      stars_test_score <span class="sc">&gt;</span> <span class="fu">median</span>(stars_test_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>      stars_test_score <span class="sc">&lt;=</span> <span class="fu">median</span>(stars_test_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"low"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> <span class="cn">NA</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Group by the new grouping variable</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(stars_test_cat) <span class="sc">|&gt;</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>( </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_mean =</span> <span class="fu">mean</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_sd =</span> <span class="fu">sd</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_se =</span> sticsa_trait_sd<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_min =</span> <span class="fu">min</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_max =</span> <span class="fu">max</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["stars_test_cat"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]},{"label":["sticsa_trait_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_se"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_min"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_max"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"high","2":"219","3":"2.50153","4":"0.5976229","5":"0.04038361","6":"1.095238","7":"3.904762"},{"1":"low","2":"246","3":"1.94714","4":"0.5353411","5":"0.03413210","6":"1.000000","7":"3.476190"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The second is to create that grouping variable ad-hoc within <code>group_by()</code>. That is, the variable you want to group by doesn’t have to already exist - you can create it on the fly within <code>group_by()</code>!</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-22"><pre class="sourceCode r code-annotation-code code-with-copy"><code class="sourceCode r"><span id="annotated-cell-22-1"><a href="#annotated-cell-22-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span></span>
<span id="annotated-cell-22-2"><a href="#annotated-cell-22-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Create stars_test_cat within group_by in a single step</span></span>
<span id="annotated-cell-22-3"><a href="#annotated-cell-22-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(<span class="at">stars_test_cat =</span> (stars_test_score <span class="sc">&lt;=</span> <span class="fu">median</span>(stars_test_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-22-4"><a href="#annotated-cell-22-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="annotated-cell-22-5"><a href="#annotated-cell-22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="annotated-cell-22-6"><a href="#annotated-cell-22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_mean =</span> <span class="fu">mean</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-22-7"><a href="#annotated-cell-22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_sd =</span> <span class="fu">sd</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-22-8"><a href="#annotated-cell-22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_se =</span> sticsa_trait_sd<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="annotated-cell-22-9"><a href="#annotated-cell-22-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_min =</span> <span class="fu">min</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="annotated-cell-22-10"><a href="#annotated-cell-22-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_max =</span> <span class="fu">max</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="annotated-cell-22-11"><a href="#annotated-cell-22-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["stars_test_cat"],"name":[1],"type":["lgl"],"align":["right"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]},{"label":["sticsa_trait_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_se"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_min"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_max"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"FALSE","2":"219","3":"2.50153","4":"0.5976229","5":"0.04038361","6":"1.095238","7":"3.904762"},{"1":"TRUE","2":"246","3":"1.94714","4":"0.5353411","5":"0.03413210","6":"1.000000","7":"3.476190"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Here I’ve gone with a simplified version of <code>stars_test_cat</code> - just TRUE or FALSE - but if I wanted to, I could use the entire <code>dplyr::case_when()</code> bit from the first <code>mutate()</code> command to get exactly the same result.</p>
</div>
</div>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="formatting-tables" class="level2">
<h2 class="anchored" data-anchor-id="formatting-tables">Formatting Tables</h2>
<p>Once we have these lovely summary tables, it would be great to include them in a report or paper, but they definitely need some formatting first. How to proceed depends on whether you are expecting to use Quarto itself for your formal reporting - and then further, what output format you will render to - or another programme (for instance, Microsoft Word).</p>
<section id="quarto-to-htmlpdf" class="level3">
<h3 class="anchored" data-anchor-id="quarto-to-htmlpdf">Quarto to HTML/PDF</h3>
<p>For UG teaching at Sussex, we have students render their assignments in Quarto to HTML, which is the default rendering output. The following techniques will also work for rendering to PDF, although this can get Complicated<sup>TM</sup>. Even if you plan to write up your final work in a different programme, it’s a good idea to render your analysis document anyway (to check for errors and review the results), and at least some basic formatting will make that output much more readable.</p>
<p>For this purpose we’ll be working primarily with the {kableExtra} package, which builds on <a href="https://yihui.org/knitr/">the {knitr} package for report generation</a>. We’ll be using a wrapper for the <code>knitr::kable()</code> function, <code>kableExtra::kbl()</code>, because {kableExtra} has a bunch of useful tools for customising the output. However, you may also want to check out <a href="https://gt.rstudio.com/">the {gt} package for powerful table formatting options</a>, and <a href="https://frederikaust.com/papaja_man/reporting.html#tables">{papaja} for some APA-like defaults</a>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For all things kable, the <a href="https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html">Create Awesome HTML Table vignette</a> is my go-to for options and examples.</p>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Follow along with the instructions to create your own beautiful table.</p>
</div>
</div>
<p>To begin, let’s take the <code>summarise()</code> code we were working with above, grouped by <code>mcq</code> only, and save it in a new object. Then, pipe that new summary dataset object into the <code>kableExtra::kbl()</code> function, and then on again into the <code>kableExtra::kable_classic()</code> function. This one-two combo first creates a basic table out of the dataset (<code>kbl()</code>), then applies some APA-ish HTML formatting (<code>kable_classic()</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>anx_mcq_sum <span class="ot">&lt;-</span> anx_scores <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(mcq) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_mean =</span> <span class="fu">mean</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_sd =</span> <span class="fu">sd</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_se =</span> sticsa_trait_sd<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_min =</span> <span class="fu">min</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticsa_trait_max =</span> <span class="fu">max</span>(sticsa_trait_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>anx_mcq_sum <span class="sc">|&gt;</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>() <span class="sc">|&gt;</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">mcq</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sticsa_trait_mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sticsa_trait_sd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sticsa_trait_se</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sticsa_trait_min</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sticsa_trait_max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">maths</td>
<td style="text-align: right;">233</td>
<td style="text-align: right;">2.168437</td>
<td style="text-align: right;">0.6462829</td>
<td style="text-align: right;">0.0423394</td>
<td style="text-align: right;">1.000000</td>
<td style="text-align: right;">3.904762</td>
</tr>
<tr class="even">
<td style="text-align: left;">stats</td>
<td style="text-align: right;">232</td>
<td style="text-align: right;">2.248214</td>
<td style="text-align: right;">0.6103040</td>
<td style="text-align: right;">0.0400684</td>
<td style="text-align: right;">1.095238</td>
<td style="text-align: right;">3.714286</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>So, already we have some basic formatting. There are a few things to do to make this table Look Nice:</p>
<ul>
<li>Format the column names</li>
<li>Round the values to two decimal places.</li>
<li>Align the columns in the center.</li>
<li>Add a caption (optional).</li>
<li>Capitalise the values “maths” and “stats” in the first column (optional)</li>
</ul>
<p>For all but the last task, we can adjust these things in <code>kbl()</code>, which has <code>col.names</code>, <code>digits</code>, <code>align</code>, and <code>caption</code> arguments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>anx_mcq_sum <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"MCQ Type"</span>, <span class="st">"N"</span>, <span class="st">"M"</span>, <span class="st">"SD"</span>, <span class="st">"SE"</span>, <span class="st">"Min"</span>, <span class="st">"Max"</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"c"</span>, <span class="co"># or l for left or r for right, or provide a vector of alignments for each column</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Descriptives for STICSA Trait Anxiety Score by MCQ Type"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Descriptives for STICSA Trait Anxiety Score by MCQ Type</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">MCQ Type</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">N</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">M</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">SD</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">maths</td>
<td style="text-align: center;">233</td>
<td style="text-align: center;">2.17</td>
<td style="text-align: center;">0.65</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">3.90</td>
</tr>
<tr class="even">
<td style="text-align: center;">stats</td>
<td style="text-align: center;">232</td>
<td style="text-align: center;">2.25</td>
<td style="text-align: center;">0.61</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">1.1</td>
<td style="text-align: center;">3.71</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="Error Watch: dimnames not equal to array extent">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Error Watch: dimnames not equal to array extent
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This error is unfortunately both very easy to generate and totally opaque. All it usually means is that the number of names (“dimnames”) you have given <code>col.names</code> isn’t the same as the number of columns in the dataset you’re formatting (the “array extent”).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>anx_mcq_sum <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="do">## if I forget to include a column name for the MCQ grouping variable</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"M"</span>, <span class="st">"SD"</span>, <span class="st">"SE"</span>, <span class="st">"Min"</span>, <span class="st">"Max"</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Descriptives for STICSA Trait Anxiety Score by MCQ Type"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"c"</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in dimnames(x) &lt;- dn: length of 'dimnames' [2] not equal to array extent</code></pre>
</div>
</div>
<p>To fix it, just double-check the columns in the dataset and make sure that the <code>col.names</code> names contain a one-to-one match for each.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the caption, keep in mind if this table will be in a longer Quarto report, you might want to instead use <a href="https://quarto.org/docs/authoring/cross-references.html#tables">cross-referencing and table captions via Quarto code chunk options</a> instead of within <code>kbl()</code>.</p>
</div>
</div>
<p>For the last task, capitalising the values in the MCQ column, we’ll have a first, brief brush with text string manipulation. Working with strings is well outside the scope of this tutorial, but for simple operations, this is a good opportunity to meet the {stringr} package.</p>
<p>{stringr} is a tidyverse package designed to make string manipulation simple and easy. Among (many!) other functions, it has some very handy functions for converting strings into particular capitalisation patterns. Here <code>str_to_sentence()</code> (for sentence case, with the first letter of the string capitalised) or <code>str_to_title()</code> (for title case, with the first letter of each word in the string capitalised) will do the same job.</p>
<p>Since our summary tibble <code>anx_mcq_sum</code> is just a dataset, we can make a change to the values in the <code>mcq</code> column just as we have seen before with <code>mutate()</code>, before passing it on to <code>kbl()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>anx_mcq_sum <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mcq =</span> stringr<span class="sc">::</span><span class="fu">str_to_sentence</span>(mcq)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"MCQ Type"</span>, <span class="st">"N"</span>, <span class="st">"M"</span>, <span class="st">"SD"</span>, <span class="st">"SE"</span>, <span class="st">"Min"</span>, <span class="st">"Max"</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"c"</span>, <span class="co"># or l for left or r for right, or provide a vector of alignments for each column</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Descriptives for STICSA Trait Anxiety Score by MCQ Type"</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Descriptives for STICSA Trait Anxiety Score by MCQ Type</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">MCQ Type</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">N</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">M</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">SD</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Maths</td>
<td style="text-align: center;">233</td>
<td style="text-align: center;">2.17</td>
<td style="text-align: center;">0.65</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">3.90</td>
</tr>
<tr class="even">
<td style="text-align: center;">Stats</td>
<td style="text-align: center;">232</td>
<td style="text-align: center;">2.25</td>
<td style="text-align: center;">0.61</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">1.1</td>
<td style="text-align: center;">3.71</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>At this point we have quite a clean, nicely formatted, and professional-looking table. Finally, render your workbook document to see your hard work in all its glory!</p>
<div class="callout callout-style-default callout-caution callout-titled" title="Regex: Capitalisation">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Regex: Capitalisation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I (JM) really love regular expressions (“regex”). If you’re not familiar with regex, it’s essentially its own mini-language for identifying patterns in character strings. Regex is slow, frustrating, and headache-inducing to learn (at least it was/is for me!), but it’s also the closest I’ve got with R to actual wizardry.</p>
<p>Since I love regex so much and this is my tutorial and no one can stop me, I’ll include these <strong>absolutely optional</strong> little regex boxes in case you’d like to learn a bit about working with regular expressions and how they can help your code. Most typically, I prefer base-R functions instead of {stringr} for working with strings, but for quick things like case changes, I find {stringr} easiest. However, the same thing can be accomplished with regular expressions instead.</p>
<p>We already saw how to convert strings to sentence case in the example above. However, all we’ve <em>actually</em> done is replaced the first letter of the string with the capitalised version of the same letter. If you happen to want to do this with base R regex instead, here’s an option:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>anx_mcq_sum <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Substitute the first character in the string with uppercase</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mcq =</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">"^(.)"</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">replacement =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">U</span><span class="sc">\\</span><span class="st">1"</span>, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> mcq, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">perl =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mcq"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]},{"label":["sticsa_trait_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_se"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_min"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_max"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"Maths","2":"233","3":"2.168437","4":"0.6462829","5":"0.04233940","6":"1.000000","7":"3.904762"},{"1":"Stats","2":"232","3":"2.248214","4":"0.6103040","5":"0.04006842","6":"1.095238","7":"3.714286"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The <code>gsub()</code> function is a regex workhorse. It <strong>g</strong>enerally <strong>sub</strong>stitutes every match to a particular pattern with a given replacement. (It has a twin, <code>sub()</code>, that only substitutes the first match rather than all of them.)</p>
<p>The three main arguments of <code>gsub()</code> are as follows.</p>
<ol type="1">
<li><code>pattern</code>: the regex pattern to search for.</li>
<li><code>replacement</code>: the replacement to substitute for any matches.</li>
<li><code>x</code>: the string (or vector of strings) to operate in.</li>
</ol>
<p>This example also includes the argument <code>perl = TRUE</code> for Reasons<sup>TM</sup> (it’s to make the <code>"\\U"</code> portion work).</p>
<p>Right, so what the hell is going on here? It’s a bit backwards in terms of the order of arguments, but let’s look at <code>x</code> first. The <code>x</code> argument essentially provides the data to work with. Here, since we’re inside <code>mutate()</code>, <code>x = mcq</code> means that the data to work with is the vector of all of the values in the <code>mcq</code> column. As a reminder, these values are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>anx_mcq_sum <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(mcq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "maths" "stats"</code></pre>
</div>
</div>
<p>Next, let’s turn to <code>pattern = "^(.)"</code>. The sequence in quotes is a regular expression to match with. Remember that regex is its own language - these symbols don’t have the same meaning as they do in regular R. This might look like a keysmash, but it has two elements:</p>
<ul>
<li><code>^</code> is the regex symbol to indicate the start of a string.</li>
<li><code>(.)</code> is a capturing group (indicated by round brackets) with a single wildcard in it (indicated by <code>.</code>) The wildcard <code>.</code> can be <em>any</em> character.</li>
</ul>
<p>Together, the expression <code>"^(.)"</code> can be read as, “The first character in the string.” This is the pattern to match, so using this expression we’ve identified (in this case) the “m” in “maths” and the “s” in “stats”.</p>
<p>Finally, let’s look at <code>replacement = "\\U\\1"</code>. Another keysmash! Remember that this argument gives the replacement for the matches to <code>pattern</code>. The <code>\\1</code> is regex for “whatever’s in the first capturing group” (here, the “m” and “s”), and <code>\\U</code> means “convert to uppercase”.</p>
<p>Together, this regex can be read as, “Find the first character in each string, then replace that character with the uppercase version of the same character.”</p>
<p>Why do this instead of <code>stringr::str_to_sentence()</code>? In this specific case I’d use {stringr} myself, but the regex way has a couple of advantages:</p>
<ol type="1">
<li><code>gsub()</code> and regex are base R, so there’s no need to install or load additional packages to use them.</li>
<li>This command can be generalised to substitute <em>any</em> match for <em>any</em> replacement, whereas the {stringr} function only does the one thing.</li>
</ol>
<p>As a final example of 2, I could change this command to put anything I’d like at the start of the string:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>anx_mcq_sum <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mcq =</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">"^(.)"</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">replacement =</span> <span class="st">"REGEX IS FUN </span><span class="sc">\\</span><span class="st">1"</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> mcq)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mcq"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]},{"label":["sticsa_trait_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_se"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_min"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["sticsa_trait_max"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"REGEX IS FUN maths","2":"233","3":"2.168437","4":"0.6462829","5":"0.04233940","6":"1.000000","7":"3.904762"},{"1":"REGEX IS FUN stats","2":"232","3":"2.248214","4":"0.6103040","5":"0.04006842","6":"1.095238","7":"3.714286"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="MoRe About: Dynaming Formatting">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
MoRe About: Dynaming Formatting
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This lengthy and complicated optional aside is included for demonstration purposes only, and is well beyond what we have or will have covered in this tutorial.</p>
<p>As I (JM) use R more, I become increasingly allergic to hard-coding <em>anything</em>. In the table we’ve produced so far, we had to type in a vector of column names to apply. I would strongly disprefer this, since I would have to check and update these names each time - and it would be easy, if copy/pasting, to mistakenly mislabel a column. Instead, I’d prefer to have column names generated from the data, which are already systematically named.</p>
<p>The first bit below includes a good bit of base R and some jiggery-pokery to get only <em>N</em> and <em>SD</em> to be italicised. (Sorry.) This is the kind of puzzle that I find really useful for making myself learn things like regular expressions, but if this isn’t your bag, don’t worry!</p>
<p>The steps are annotated below, which together produce a vector of column names to pass to <code>kbl()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sub all instances of "sticsa_trait_" with an empty string</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Which just effectively deletes them</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>anx_mcq_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">"sticsa_trait_"</span>, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">replacement =</span> <span class="st">""</span>, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">names</span>(anx_mcq_sum)) <span class="sc">|&gt;</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Then convert to title case</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_to_title</span>() <span class="sc">|&gt;</span> </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## substitute all instances of either "Mcq", "Sd", "Se" to uppercase</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">## no x argument here because it's the first unnamed argument</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">## so piped in from above</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">"(Mcq|Sd|Se)"</span>, </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">replacement =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">U</span><span class="sc">\\</span><span class="st">1"</span>, </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">perl =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Check where we're at so far</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>anx_mcq_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MCQ"  "N"    "Mean" "SD"   "SE"   "Min"  "Max" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Replace the values in anx_mcq_names that match N, SD, or SE</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>anx_mcq_names[<span class="fu">which</span>(anx_mcq_names <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"SD"</span>, <span class="st">"SE"</span>))] <span class="ot">&lt;-</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## with HTML italics formatting</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(kableExtra<span class="sc">::</span><span class="fu">text_spec</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"SD"</span>, <span class="st">"SE"</span>), <span class="at">italic =</span> <span class="cn">TRUE</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>       ), <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="do">## View the final vector of column names</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>anx_mcq_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MCQ"                                                
[2] "&lt;span style=\"  font-style: italic;   \" &gt;N&lt;/span&gt;" 
[3] "Mean"                                               
[4] "&lt;span style=\"  font-style: italic;   \" &gt;SD&lt;/span&gt;"
[5] "&lt;span style=\"  font-style: italic;   \" &gt;SE&lt;/span&gt;"
[6] "Min"                                                
[7] "Max"                                                </code></pre>
</div>
</div>
<p>We can then replace the vector of names with the new vector we’ve just produced, adding <code>escape = FALSE</code> into the <code>kbl()</code> function so that the HTML formatting appears correctly.</p>
<p>Using the “Grouped Columns/Rows” section of the Awesome Tables vignette, we can also find the function <code>add_header_above()</code>, which requires us to specify which header we want above which columns using numbers. So, I have six total columns in the <code>anx_mcq_sum</code> summary dataset; I don’t want any header above the first two (“MCQ” and “N”), but I do want a header above the last five.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>anx_mcq_sum <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> anx_mcq_names,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Descriptives for STICSA Trait Anxiety Score by MCQ Type"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"c"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">escape =</span> <span class="cn">FALSE</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"STICSA Trait Anxiety Score"</span> <span class="ot">=</span> <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Descriptives for STICSA Trait Anxiety Score by MCQ Type</caption>
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="5" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
STICSA Trait Anxiety Score
</div></th>
</tr>
<tr class="odd">
<th style="text-align: center;" data-quarto-table-cell-role="th">MCQ</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">N</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">SD</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">SE</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">maths</td>
<td style="text-align: center;">233</td>
<td style="text-align: center;">2.17</td>
<td style="text-align: center;">0.65</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">3.90</td>
</tr>
<tr class="even">
<td style="text-align: center;">stats</td>
<td style="text-align: center;">232</td>
<td style="text-align: center;">2.25</td>
<td style="text-align: center;">0.61</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">1.1</td>
<td style="text-align: center;">3.71</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>The magic of this approach is that it can be expanded to apply to as many inputs as you give it. Let’s take our iterated summary from the previous section and turn the code editing the names into a function, and then use that within <code>kbl()</code> to generate the column names.</p>
<p>I already said this above, but this involves custom function writing, regular expressions/{stringr}, and conditionally manipulating string vectors. This is included just to demonstrate that it can be done, but is definitely not within the skills covered in these tutorials.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-32"><pre class="sourceCode r code-annotation-code code-with-copy"><code class="sourceCode r"><span id="annotated-cell-32-1"><a href="#annotated-cell-32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Save the summary dataset as a new object </span></span>
<span id="annotated-cell-32-2"><a href="#annotated-cell-32-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Using the fxs list of functions from before</span></span>
<span id="annotated-cell-32-3"><a href="#annotated-cell-32-3" aria-hidden="true" tabindex="-1"></a>anx_stars_sum <span class="ot">&lt;-</span> anx_scores <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-32-4"><a href="#annotated-cell-32-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(mcq) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-32-5"><a href="#annotated-cell-32-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="annotated-cell-32-6"><a href="#annotated-cell-32-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"stars"</span>), fns)</span>
<span id="annotated-cell-32-7"><a href="#annotated-cell-32-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-32-8"><a href="#annotated-cell-32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-32-9"><a href="#annotated-cell-32-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Write a custom function to automatically format column names</span></span>
<span id="annotated-cell-32-10"><a href="#annotated-cell-32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-32-11"><a href="#annotated-cell-32-11" aria-hidden="true" tabindex="-1"></a>format_kbl_colnames <span class="ot">&lt;-</span> <span class="cf">function</span>(summary_data, <span class="at">all_caps =</span> <span class="cn">NULL</span>, <span class="at">italics =</span> <span class="cn">NULL</span>){</span>
<span id="annotated-cell-32-12"><a href="#annotated-cell-32-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-32-13"><a href="#annotated-cell-32-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Set column names to always capitalise and italicise</span></span>
<span id="annotated-cell-32-14"><a href="#annotated-cell-32-14" aria-hidden="true" tabindex="-1"></a>  default_caps <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sd"</span>, <span class="st">"se"</span>, <span class="st">"n"</span>)</span>
<span id="annotated-cell-32-15"><a href="#annotated-cell-32-15" aria-hidden="true" tabindex="-1"></a>  default_italics <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sd"</span>, <span class="st">"se"</span>, <span class="st">"n"</span>)</span>
<span id="annotated-cell-32-16"><a href="#annotated-cell-32-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-32-17"><a href="#annotated-cell-32-17" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Get initial vector of column names</span></span>
<span id="annotated-cell-32-18"><a href="#annotated-cell-32-18" aria-hidden="true" tabindex="-1"></a>  kbl_colnames <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">".*_(.*)"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, <span class="fu">names</span>(summary_data)) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-32-19"><a href="#annotated-cell-32-19" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_to_title</span>()</span>
<span id="annotated-cell-32-20"><a href="#annotated-cell-32-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-32-21"><a href="#annotated-cell-32-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Identify which elements to convert to uppercase (in addition to defaults) and do so</span></span>
<span id="annotated-cell-32-22"><a href="#annotated-cell-32-22" aria-hidden="true" tabindex="-1"></a>  capitalise_these <span class="ot">&lt;-</span> kbl_colnames[<span class="fu">which</span>(<span class="fu">tolower</span>(kbl_colnames) <span class="sc">%in%</span> <span class="fu">tolower</span>(all_caps) <span class="sc">|</span> <span class="fu">tolower</span>(kbl_colnames) <span class="sc">%in%</span> default_caps)]</span>
<span id="annotated-cell-32-23"><a href="#annotated-cell-32-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-32-24"><a href="#annotated-cell-32-24" aria-hidden="true" tabindex="-1"></a>  kbl_colnames[<span class="fu">which</span>(kbl_colnames <span class="sc">%in%</span> capitalise_these)] <span class="ot">&lt;-</span> <span class="fu">toupper</span>(capitalise_these)</span>
<span id="annotated-cell-32-25"><a href="#annotated-cell-32-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-32-26"><a href="#annotated-cell-32-26" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Identify which elements to convert to italics (in addition to defaults) and do so</span></span>
<span id="annotated-cell-32-27"><a href="#annotated-cell-32-27" aria-hidden="true" tabindex="-1"></a>  italicise_these <span class="ot">&lt;-</span> kbl_colnames[<span class="fu">which</span>(<span class="fu">tolower</span>(kbl_colnames) <span class="sc">%in%</span> <span class="fu">tolower</span>(italics) <span class="sc">|</span> <span class="fu">tolower</span>(kbl_colnames) <span class="sc">%in%</span> default_italics)]</span>
<span id="annotated-cell-32-28"><a href="#annotated-cell-32-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-32-29"><a href="#annotated-cell-32-29" aria-hidden="true" tabindex="-1"></a>  kbl_colnames[<span class="fu">which</span>(kbl_colnames <span class="sc">%in%</span> italicise_these)] <span class="ot">&lt;-</span></span>
<span id="annotated-cell-32-30"><a href="#annotated-cell-32-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(kableExtra<span class="sc">::</span><span class="fu">text_spec</span>(</span>
<span id="annotated-cell-32-31"><a href="#annotated-cell-32-31" aria-hidden="true" tabindex="-1"></a>      italicise_these, <span class="at">italic =</span> <span class="cn">TRUE</span></span>
<span id="annotated-cell-32-32"><a href="#annotated-cell-32-32" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="annotated-cell-32-33"><a href="#annotated-cell-32-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-32-34"><a href="#annotated-cell-32-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(kbl_colnames)</span>
<span id="annotated-cell-32-35"><a href="#annotated-cell-32-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="annotated-cell-32-36"><a href="#annotated-cell-32-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-32-37"><a href="#annotated-cell-32-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a named vector of formatted column names and counts for the header</span></span>
<span id="annotated-cell-32-38"><a href="#annotated-cell-32-38" aria-hidden="true" tabindex="-1"></a>header_vals <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="annotated-cell-32-39"><a href="#annotated-cell-32-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">var =</span> <span class="fu">names</span>(anx_stars_sum) </span>
<span id="annotated-cell-32-40"><a href="#annotated-cell-32-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-32-41"><a href="#annotated-cell-32-41" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="annotated-cell-32-42"><a href="#annotated-cell-32-42" aria-hidden="true" tabindex="-1"></a>      <span class="do">## This is a whole lot of string manipulation</span></span>
<span id="annotated-cell-32-43"><a href="#annotated-cell-32-43" aria-hidden="true" tabindex="-1"></a>      <span class="do">## to turn variable names into human-readable ones</span></span>
<span id="annotated-cell-32-44"><a href="#annotated-cell-32-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">var =</span>  <span class="fu">gsub</span>(<span class="st">"(.*_)(.*)(_score.*)"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">U</span><span class="sc">\\</span><span class="st">1</span><span class="sc">\\</span><span class="st">E</span><span class="sc">\\</span><span class="st">2"</span>, var, <span class="at">perl =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-32-45"><a href="#annotated-cell-32-45" aria-hidden="true" tabindex="-1"></a>        <span class="fu">gsub</span>(<span class="st">"_M"</span>, <span class="st">"-M"</span>, <span class="at">x =</span> _) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-32-46"><a href="#annotated-cell-32-46" aria-hidden="true" tabindex="-1"></a>        <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, <span class="at">x =</span> _) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-32-47"><a href="#annotated-cell-32-47" aria-hidden="true" tabindex="-1"></a>        <span class="fu">gsub</span>(<span class="st">"(.*) (.)(.*)"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1 </span><span class="sc">\\</span><span class="st">U</span><span class="sc">\\</span><span class="st">2</span><span class="sc">\\</span><span class="st">E</span><span class="sc">\\</span><span class="st">3"</span>, <span class="at">x =</span> _, <span class="at">perl =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-32-48"><a href="#annotated-cell-32-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">var =</span> <span class="fu">gsub</span>(<span class="st">"mcq"</span>, <span class="st">"MCQ"</span>, var)</span>
<span id="annotated-cell-32-49"><a href="#annotated-cell-32-49" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-32-50"><a href="#annotated-cell-32-50" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Have to use summarise(n()) here because count() reorders the levels</span></span>
<span id="annotated-cell-32-51"><a href="#annotated-cell-32-51" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Which would mean summary columns would be mislabeled!</span></span>
<span id="annotated-cell-32-52"><a href="#annotated-cell-32-52" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="annotated-cell-32-53"><a href="#annotated-cell-32-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="annotated-cell-32-54"><a href="#annotated-cell-32-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">.by =</span> var</span>
<span id="annotated-cell-32-55"><a href="#annotated-cell-32-55" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-32-56"><a href="#annotated-cell-32-56" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Turn the tibble into a vector</span></span>
<span id="annotated-cell-32-57"><a href="#annotated-cell-32-57" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">deframe</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As if all that weren’t bad enough, this is one of those situations where the native pipe just doesn’t cut it. Using the {magrittr} pipe, we can easily use our new custom function inside our <code>kbl()</code> code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>anx_stars_sum <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">format_kbl_colnames</span>(., <span class="at">all_caps =</span> <span class="st">"mcq"</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Descriptives for STARS subscales by MCQ Type"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"c"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">escape =</span> <span class="cn">FALSE</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Use the vector to create headers</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">add_header_above</span>(header_vals) <span class="sc">|&gt;</span> </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Descriptives for STARS subscales by MCQ Type</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MCQ
</div></th>
<th colspan="6" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
STARS Test
</div></th>
<th colspan="6" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
STARS Int
</div></th>
<th colspan="6" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
STARS Help
</div></th>
<th colspan="6" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
STARS-M Test
</div></th>
<th colspan="6" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
STARS-M Int
</div></th>
<th colspan="6" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
STARS-M Help
</div></th>
</tr>
<tr class="odd">
<th style="text-align: center;" data-quarto-table-cell-role="th">MCQ</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">N</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">SD</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">SE</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Max</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">N</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">SD</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">SE</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Max</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">N</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">SD</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">SE</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Max</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">N</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">SD</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">SE</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Max</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">N</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">SD</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">SE</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Max</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">N</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">SD</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th"><span style="  font-style: italic;   ">SE</span></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">maths</td>
<td style="text-align: center;">233</td>
<td style="text-align: center;">3.41</td>
<td style="text-align: center;">0.91</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1.12</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">233</td>
<td style="text-align: center;">2.63</td>
<td style="text-align: center;">0.89</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5.00</td>
<td style="text-align: center;">233</td>
<td style="text-align: center;">2.74</td>
<td style="text-align: center;">1.14</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">233</td>
<td style="text-align: center;">3.31</td>
<td style="text-align: center;">0.93</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">233</td>
<td style="text-align: center;">2.58</td>
<td style="text-align: center;">0.94</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5.00</td>
<td style="text-align: center;">233</td>
<td style="text-align: center;">2.71</td>
<td style="text-align: center;">1.12</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;">stats</td>
<td style="text-align: center;">232</td>
<td style="text-align: center;">3.43</td>
<td style="text-align: center;">0.82</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1.25</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">232</td>
<td style="text-align: center;">2.57</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4.82</td>
<td style="text-align: center;">232</td>
<td style="text-align: center;">2.93</td>
<td style="text-align: center;">1.10</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">232</td>
<td style="text-align: center;">3.27</td>
<td style="text-align: center;">0.87</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">232</td>
<td style="text-align: center;">2.44</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4.88</td>
<td style="text-align: center;">232</td>
<td style="text-align: center;">2.79</td>
<td style="text-align: center;">1.04</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>So there you have it: a (mostly) fully automated and nicely formatted table requiring no hard-coding of specific names or variables, at the bargain price of a few precious hours of my life and a not-insubstantial chunk of my sanity.</p>
</div>
</div>
</div>
</section>
<section id="exporting" class="level3">
<h3 class="anchored" data-anchor-id="exporting">Exporting</h3>
<p>If you are writing your work exterior to Quarto/your code, you will instead need to export your summary and then import it into the new document. However, it’s essential to keep a close eye on changes or updates, so that tables don’t get out of date if the source data is updated.</p>
<section id="creating-a-folder" class="level4">
<h4 class="anchored" data-anchor-id="creating-a-folder">Creating a Folder</h4>
<p>We’ll first need to create a folder to save our summary tables in. You can (and likely will!) do this manually, by clicking. Both Posit Cloud and RStudio Desktop have a + Folder button (the first one in the Files tab), which will create a new folder in whatever folder you are currently looking at. Make sure you are in the project folder, then enter the folder name and click OK.</p>
<p><img src="../../images/new_folder.jpg" class="img-fluid" alt="Screenshot of the Files pane with arrows showing the steps to create a new folder"></p>
<p>If you want your entire workflow to be entirely reproducible - even creating folders! - see the box below.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="MoRe About: Managing Folders with R">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
MoRe About: Managing Folders with R
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The “problem” (such as it is) with creating folders by clicking is that there’s no record of that action in your code. If you pass on the code - but not the entire project folder - to someone else, and they try to run it, they’ll get an error because the target folder doesn’t happen to exist in their files. We could resolve this by using R to interact with the folders on your computer (or in your Cloud project) so that the folder is created by the code itself.</p>
<p>Let’s write some generalisable code to create a folder. To begin, we’ll store the path to the new folder in an object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>new_folder_path <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"summaries"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The next step <em>could</em> be to simply create the folder with <code>dir.create()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(new_folder_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>But this operation will fail and throw a warning if the folder already exists. (This is great, as otherwise you could easily overwrite existing folders!) So, let’s instead write an <strong>if statement</strong> to only run this code if the specified folder doesn’t exist already.</p>
<p><code>if</code> and other conditionals in R look a bit different than normal commands. The function <code>if()</code> needs a statement that evaluates to a single <code>TRUE</code> or <code>FALSE</code>. It’s then followed by additional code in curly braces <code>{}</code>. If the condition(s) in <code>if()</code> evaluate to <code>TRUE</code>, then the code in the curly braces is executed; if <code>FALSE</code>, they are not. (You can also supply an <code>else</code>, but we don’t need it here.)</p>
<p>So, to avoid alarming warnings or any accidental overwriting, we can write:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(new_folder_path)){</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(new_folder_path)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function <code>dir.exists()</code>, as you might expect, looks for a folder at the supplied location (in this case, at the path we stored in <code>new_folder_path</code>), and returns <code>TRUE</code> if the directory exists or <code>FALSE</code> if it doesn’t. By adding an exclamation mark, we invert those results: now the expression <code>!dir.exists(new_folder_path)</code> returns <code>TRUE</code> if the folder <strong>doesn’t</strong> exist. That’s what we want because if the folder we want to create doesn’t already exist, then the next bit of code, <code>dir.create(new_folder_path)</code>, is executed to create the folder. Otherwise, if the folder <strong>does</strong> already exist, nothing happens.</p>
<p>If you already created the <code>summaries</code> folder with the GUI interface, you will find that this code doesn’t do anything because the folder already exists!</p>
<p>In any case it’s important to think carefully about including any code that makes changes to the user’s computer system and files. I usually comment out these elements of my code unless I’m sure I need to use them.</p>
</div>
</div>
</div>
</section>
<section id="exporting-1" class="level4">
<h4 class="anchored" data-anchor-id="exporting-1">Exporting</h4>
<p>The summary data is just a dataset, so we can export it just as we did previously with whole datasets with <code>write_csv()</code>. We need to provide the name of the data to write and a file path that includes the name and file extension of the file we want to create.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_csv</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Name of the object containing data to write</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  anx_scores_sum,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># File path where the file should be saved</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Including the name and file extension of the file itself</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"summaries/anx_scores_sum.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="repro">
<div class="repro-header">
<div class="repro-icon">

</div>
<p>RepRoducibility: Copying tables</p>
</div>
<div class="repro-body">
<p>At this point you will have a summary dataset, in the form of a CSV file, that you can then import or copy/paste into another document. This is an undocumented step - that is, a step that is not recorded anywhere in your code, just <em>done</em> manually. Naturally, you will need to be quite careful to cross-check the numbers and labeling produced by your summarising code vs the summaries in your final document, and remember to update or recreate any tables in separate documents if your data or analyses change.</p>
<p>Ideally, we would be able to link datasets like this to tables in other documents, so they would update automatically, as we will see is possible with images later on. Unfortunately this doesn’t currently appear to be easily accomplished, so vigilance and careful checking are needed!</p>
</div>
</div>
</section>
</section>
</section>
<section id="quick-test-correlation" class="level2">
<h2 class="anchored" data-anchor-id="quick-test-correlation">Quick Test: Correlation</h2>
<p>Whew! Well done so far; let’s cool down with some snazzy plots and a nice gentle correlation analysis.</p>
<p>This bit is meant to be quick, so we’ll only look briefly at what we teach in UG at Sussex. If you want more correlation fun, check out <code>discovr</code> tutorials 07 and 18.</p>
<section id="visualisation" class="level3">
<h3 class="anchored" data-anchor-id="visualisation">Visualisation</h3>
<p>In first year, we teach the function <code>GGally::ggscatmat()</code>, which is a quick way to generate a complex plot with lots of useful info, relatively painlessly. However, <code>ggscatmat()</code> (if you’re wondering, that’s G-G-scat-mat, like “scatterplot matrix”) will only work on numeric variables, so we’ll need to <code>select()</code> the ones we want first. Let’s return for this example to our familiar STICSA scores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## starts_with() also fine in this case</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"sticsa"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  GGally<span class="sc">::</span><span class="fu">ggscatmat</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_summarise_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Functions like <code>ggscatmat()</code> output a special kind of plot created with {ggplot2}, another core {tidyverse} package. The lovely thing about ggplot-creating functions like this is that they do a lot of the heavy lifting of plot creation for you - getting a bunch of the complicated structure and setup out of the way - and then you can customise the plot further using {ggplot2}.</p>
<p>If you haven’t used {ggplot2} before, we’ll work through it systematically in an upcoming tutorial. If you can’t wait, check out:</p>
<ul>
<li><a href="https://r-graph-gallery.com/">The R Graph Gallery</a></li>
<li><code>discovr_05</code> on data visualisation with {ggplot2}</li>
<li><a href="https://r4ds.had.co.nz/data-visualisation.html">R for Data Science chapter 3</a></li>
<li>This <a href="https://sites.northwestern.edu/researchcomputing/2020/04/13/online-learning-resources-r-ggplot2/">list of {ggplot2} resources</a></li>
</ul>
</div>
</div>
<p>So, this single function gets us a pretty complex plot: a matrix containing all of our variables along the top and side, with density plots on the diagonal, scatterplots on one pairwise intersection, and correlation coefficients on the other.</p>
<p>This is the only {GGally} function we teach in UG at Sussex, but to go a bit further, there’s another example below as a challenge exercise that might be useful in the future.</p>
</section>
<section id="testing-correlation" class="level3">
<h3 class="anchored" data-anchor-id="testing-correlation">Testing Correlation</h3>
<p>In both first and second year, UGs are introduced to the tonguetwister function <a href="https://github.com/easystats/correlation"><code>correlation::correlation()</code> from the {easystats} family</a>.</p>
<p>For any number of pairs of variables, including one, you can get easy pairwise correlations with this function. It also has a major upside of applying Holm <em>p</em>-value adjustments for multiple comparisons by default. It’s also delightfully easy to use (it is from the {easystats} family after all) - just <code>select()</code> the variables you want to correlate, for example the STICSA scales again, and then pipe them on into the function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"sticsa"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  correlation<span class="sc">::</span><span class="fu">correlation</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Parameter1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Parameter2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["r"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CI"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CI_low"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CI_high"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["t"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df_error"],"name":[8],"type":["int"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Method"],"name":[10],"type":["chr"],"align":["left"]},{"label":["n_Obs"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"sticsa_trait_score","2":"sticsa_pre_state_score","3":"0.7582265","4":"0.95","5":"0.7167086","6":"0.7943885","7":"25.02348","8":"463","9":"9.624755e-88","10":"Pearson correlation","11":"465","_rn_":"1"},{"1":"sticsa_trait_score","2":"sticsa_post_state_score","3":"0.6901984","4":"0.95","5":"0.6392774","6":"0.7350929","7":"20.47924","8":"461","9":"9.210053e-67","10":"Pearson correlation","11":"463","_rn_":"2"},{"1":"sticsa_pre_state_score","2":"sticsa_post_state_score","3":"0.7828117","4":"0.95","5":"0.7448150","6":"0.8157483","7":"27.01076","8":"461","9":"1.490476e-96","10":"Pearson correlation","11":"463","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="exercises-1" class="level2">
<h2 class="anchored" data-anchor-id="exercises-1">Exercises</h2>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Perform pairwise correlations on all the STARS subscales in this dataset.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s do the same as above, just replacing the string in <code>contains()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"stars"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  correlation<span class="sc">::</span><span class="fu">correlation</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Parameter1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Parameter2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["r"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CI"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CI_low"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CI_high"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["t"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df_error"],"name":[8],"type":["int"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Method"],"name":[10],"type":["chr"],"align":["left"]},{"label":["n_Obs"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"stars_test_score","2":"stars_int_score","3":"0.6912697","4":"0.95","5":"0.6406041","6":"0.7359424","7":"20.584579","8":"463","9":"2.994345e-66","10":"Pearson correlation","11":"465","_rn_":"1"},{"1":"stars_test_score","2":"stars_help_score","3":"0.5118461","4":"0.95","5":"0.4414595","6":"0.5759718","7":"12.820285","8":"463","9":"1.030516e-31","10":"Pearson correlation","11":"465","_rn_":"2"},{"1":"stars_test_score","2":"stars_m_test_score","3":"0.8031353","4":"0.95","5":"0.7683130","6":"0.8332174","7":"29.005546","8":"463","9":"4.446231e-105","10":"Pearson correlation","11":"465","_rn_":"3"},{"1":"stars_test_score","2":"stars_m_int_score","3":"0.6156415","4":"0.95","5":"0.5558241","6":"0.6691165","7":"16.810384","8":"463","9":"7.523748e-49","10":"Pearson correlation","11":"465","_rn_":"4"},{"1":"stars_test_score","2":"stars_m_help_score","3":"0.4871426","4":"0.95","5":"0.4145734","6":"0.5535552","7":"12.002506","8":"463","9":"1.754771e-28","10":"Pearson correlation","11":"465","_rn_":"5"},{"1":"stars_int_score","2":"stars_help_score","3":"0.5174873","4":"0.95","5":"0.4476170","6":"0.5810773","7":"13.012876","8":"463","9":"1.965068e-32","10":"Pearson correlation","11":"465","_rn_":"6"},{"1":"stars_int_score","2":"stars_m_test_score","3":"0.5684354","4":"0.95","5":"0.5035289","6":"0.6269616","7":"14.866727","8":"463","9":"3.389827e-40","10":"Pearson correlation","11":"465","_rn_":"7"},{"1":"stars_int_score","2":"stars_m_int_score","3":"0.8347016","4":"0.95","5":"0.8048586","6":"0.8603338","7":"32.614044","8":"463","9":"6.881959e-121","10":"Pearson correlation","11":"465","_rn_":"8"},{"1":"stars_int_score","2":"stars_m_help_score","3":"0.4780945","4":"0.95","5":"0.4047575","6":"0.5453206","7":"11.712706","8":"463","9":"1.870684e-27","10":"Pearson correlation","11":"465","_rn_":"9"},{"1":"stars_help_score","2":"stars_m_test_score","3":"0.4130083","4":"0.95","5":"0.3346424","6":"0.4857010","7":"9.758002","8":"463","9":"1.397425e-20","10":"Pearson correlation","11":"465","_rn_":"10"},{"1":"stars_help_score","2":"stars_m_int_score","3":"0.4331382","4":"0.95","5":"0.3562354","6":"0.5042127","7":"10.340330","8":"463","9":"2.187850e-22","10":"Pearson correlation","11":"465","_rn_":"11"},{"1":"stars_help_score","2":"stars_m_help_score","3":"0.8625230","4":"0.95","5":"0.8372574","6":"0.8841136","7":"36.677136","8":"463","9":"6.881364e-138","10":"Pearson correlation","11":"465","_rn_":"12"},{"1":"stars_m_test_score","2":"stars_m_int_score","3":"0.6816839","4":"0.95","5":"0.6297896","6":"0.7275202","7":"20.048048","8":"463","9":"8.855890e-64","10":"Pearson correlation","11":"465","_rn_":"13"},{"1":"stars_m_test_score","2":"stars_m_help_score","3":"0.5499319","4":"0.95","5":"0.4831595","6":"0.6103440","7":"14.167850","8":"463","9":"3.317842e-37","10":"Pearson correlation","11":"465","_rn_":"14"},{"1":"stars_m_int_score","2":"stars_m_help_score","3":"0.5250828","4":"0.95","5":"0.4559180","6":"0.5879436","7":"13.275858","8":"463","9":"1.823232e-33","10":"Pearson correlation","11":"465","_rn_":"15"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Yikes, that’s a lot of pairwise comparisons - and they’re all significant, hooray.</p>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>CHALLENGE</strong>: Pick a single pair from the pairwise correlations, generate the correlation output, and report the result.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I’m going to pick one of the pairs first and get the correlation output for just that pair, then pipe on to <code>report()</code> - easy right?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"test"</span>) <span class="sc">&amp;</span> <span class="fu">contains</span>(<span class="st">"stars"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  correlation<span class="sc">::</span><span class="fu">correlation</span>() <span class="sc">|&gt;</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  report<span class="sc">::</span><span class="fu">report</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in names(n_char) &lt;- c("Entry", "n_Entry"): 'names' attribute [2] must be the same length as the vector [1]</code></pre>
</div>
</div>
<p>Oops! What a weird error. If you were wondering why this seemingly simple task is a challenge, this is why.</p>
<p>Looking at the <code>report()</code> documentation, we don’t see any evidence that this function works with the output from <code>correlation()</code> - and indeed, it doesn’t (yet!). But it <em>can</em> report correlations for <code>htest</code> objects.</p>
<p><code>htest</code> is short for <em>hypothesis test</em>, and is a class of object produced by base-R {stats} functions, like <code>t.test()</code> - or <code>cor.test()</code>, the function for pairwise correlation testing. So, to easily <code>report()</code> this test, we’ll have to rerun our correlation with the <code>cor.test()</code> function.</p>
<p>Looking at the <code>cor.test()</code> help documentation, there are a couple of ways to provide the variables to use. I (JM) personally prefer the formula option, so we can run the same pairwise correlation as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="sc">~</span> stars_test_score <span class="sc">+</span> stars_m_test_score, <span class="at">data =</span> anx_scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  stars_test_score and stars_m_test_score
t = 29.006, df = 463, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.7683130 0.8332174
sample estimates:
      cor 
0.8031353 </code></pre>
</div>
</div>
<p>The text output gives us a summary of our results, but more importantly, outputs an <code>htest</code> object containing those results that we can pass on to <code>report()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="sc">~</span> stars_test_score <span class="sc">+</span> stars_m_test_score, <span class="at">data =</span> anx_scores) <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  report<span class="sc">::</span><span class="fu">report</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Funder's (2019) recommendations.

The Pearson's product-moment correlation between stars_test_score and
stars_m_test_score is positive, statistically significant, and very large (r =
0.80, 95% CI [0.77, 0.83], t(463) = 29.01, p &lt; .001)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>CHALLENGE</strong>: Use <code>GGally::ggpairs()</code> on the same numeric variables, but split up all the plots by <code>mcq</code> as well. Here we’re getting at a key question of the original study: are maths and stats anxiety actually different?</p>
<p><em>Hint</em>: There’s an example of this code in <a href="https://allisonhorst.github.io/palmerpenguins/articles/intro.html">the introduction documentation for the lovely <code>palmerpenguins::penguins</code> dataset</a>!</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The <a href="https://allisonhorst.github.io/palmerpenguins/articles/intro.html#exploring-correlations">“Exploring Correlations” section</a> of the <code>palmerpenguins</code> document gives an example of this code.</p>
<p>To adapt it, first, remember to select both the grouping variable <code>mcq</code> AND the numeric outcome variables.</p>
<p>Second, use the <code>aes()</code> function in <code>ggpairs()</code> to assign different colours to the different categories in <code>mcq</code>. We’ll look at <code>aes()</code> a lot more when we get to {ggplot2}.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>anx_scores <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mcq, <span class="fu">contains</span>(<span class="st">"stars"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  GGally<span class="sc">::</span><span class="fu">ggpairs</span>(<span class="fu">aes</span>(<span class="at">color =</span> mcq))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_summarise_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The example of this in the {palmerpenguins} intro document also changes the default colours, which is something we’ll look at when we take a tour through {ggplot2} ourselves.</p>
</div>
</div>
</div>
</div>
</div>
<p>&nbsp;</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© Jennifer Mankin 2024</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>